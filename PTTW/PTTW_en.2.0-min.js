 /* Build Time: Oct 1, 2014 12:39:13 */ /*yepnope1.5.x|WTFPL*/
(function(a,b,c){function d(a){return"[object Function]"==o.call(a)}function e(a){return"string"==typeof a}function f(){}function g(a){return!a||"loaded"==a||"complete"==a||"uninitialized"==a}function h(){var a=p.shift();q=1,a?a.t?m(function(){("c"==a.t?B.injectCss:B.injectJs)(a.s,0,a.a,a.x,a.e,1)},0):(a(),h()):q=0}function i(a,c,d,e,f,i,j){function k(b){if(!o&&g(l.readyState)&&(u.r=o=1,!q&&h(),l.onload=l.onreadystatechange=null,b)){"img"!=a&&m(function(){t.removeChild(l)},50);for(var d in y[c])y[c].hasOwnProperty(d)&&y[c][d].onload()}}var j=j||B.errorTimeout,l=b.createElement(a),o=0,r=0,u={t:d,s:c,e:f,a:i,x:j};1===y[c]&&(r=1,y[c]=[]),"object"==a?l.data=c:(l.src=c,l.type=a),l.width=l.height="0",l.onerror=l.onload=l.onreadystatechange=function(){k.call(this,r)},p.splice(e,0,u),"img"!=a&&(r||2===y[c]?(t.insertBefore(l,s?null:n),m(k,j)):y[c].push(l))}function j(a,b,c,d,f){return q=0,b=b||"j",e(a)?i("c"==b?v:u,a,b,this.i++,c,d,f):(p.splice(this.i++,0,a),1==p.length&&h()),this}function k(){var a=B;return a.loader={load:j,i:0},a}var l=b.documentElement,m=a.setTimeout,n=b.getElementsByTagName("script")[0],o={}.toString,p=[],q=0,r="MozAppearance"in l.style,s=r&&!!b.createRange().compareNode,t=s?l:n.parentNode,l=a.opera&&"[object Opera]"==o.call(a.opera),l=!!b.attachEvent&&!l,u=r?"object":l?"script":"img",v=l?"script":u,w=Array.isArray||function(a){return"[object Array]"==o.call(a)},x=[],y={},z={timeout:function(a,b){return b.length&&(a.timeout=b[0]),a}},A,B;B=function(a){function b(a){var a=a.split("!"),b=x.length,c=a.pop(),d=a.length,c={url:c,origUrl:c,prefixes:a},e,f,g;for(f=0;f<d;f++)g=a[f].split("="),(e=z[g.shift()])&&(c=e(c,g));for(f=0;f<b;f++)c=x[f](c);return c}function g(a,e,f,g,h){var i=b(a),j=i.autoCallback;i.url.split(".").pop().split("?").shift(),i.bypass||(e&&(e=d(e)?e:e[a]||e[g]||e[a.split("/").pop().split("?")[0]]),i.instead?i.instead(a,e,f,g,h):(y[i.url]?i.noexec=!0:y[i.url]=1,f.load(i.url,i.forceCSS||!i.forceJS&&"css"==i.url.split(".").pop().split("?").shift()?"c":c,i.noexec,i.attrs,i.timeout),(d(e)||d(j))&&f.load(function(){k(),e&&e(i.origUrl,h,g),j&&j(i.origUrl,h,g),y[i.url]=2})))}function h(a,b){function c(a,c){if(a){if(e(a))c||(j=function(){var a=[].slice.call(arguments);k.apply(this,a),l()}),g(a,j,b,0,h);else if(Object(a)===a)for(n in m=function(){var b=0,c;for(c in a)a.hasOwnProperty(c)&&b++;return b}(),a)a.hasOwnProperty(n)&&(!c&&!--m&&(d(j)?j=function(){var a=[].slice.call(arguments);k.apply(this,a),l()}:j[n]=function(a){return function(){var b=[].slice.call(arguments);a&&a.apply(this,b),l()}}(k[n])),g(a[n],j,b,n,h))}else!c&&l()}var h=!!a.test,i=a.load||a.both,j=a.callback||f,k=j,l=a.complete||f,m,n;c(h?a.yep:a.nope,!!i),i&&c(i)}var i,j,l=this.yepnope.loader;if(e(a))g(a,0,l,0);else if(w(a))for(i=0;i<a.length;i++)j=a[i],e(j)?g(j,0,l,0):w(j)?B(j):Object(j)===j&&h(j,l);else Object(a)===a&&h(a,l)},B.addPrefix=function(a,b){z[a]=b},B.addFilter=function(a){x.push(a)},B.errorTimeout=1e4,null==b.readyState&&b.addEventListener&&(b.readyState="loading",b.addEventListener("DOMContentLoaded",A=function(){b.removeEventListener("DOMContentLoaded",A,0),b.readyState="complete"},0)),a.yepnope=k(),a.yepnope.executeStack=h,a.yepnope.injectJs=function(a,c,d,e,i,j){var k=b.createElement("script"),l,o,e=e||B.errorTimeout;k.src=a;for(o in d)k.setAttribute(o,d[o]);c=j?h:c||f,k.onreadystatechange=k.onload=function(){!l&&g(k.readyState)&&(l=1,c(),k.onload=k.onreadystatechange=null)},m(function(){l||(l=1,c(1))},e),i?k.onload():n.parentNode.insertBefore(k,n)},a.yepnope.injectCss=function(a,c,d,e,g,i){var e=b.createElement("link"),j,c=i?h:c||f;e.href=a,e.rel="stylesheet",e.type="text/css";for(j in d)e.setAttribute(j,d[j]);g||(n.parentNode.insertBefore(e,n),m(c,0))}})(this,document);
var dependOnGoogleMaps = true;/*
arcgislink.js (http://google-maps-utility-library-v3.googlecode.com/svn/trunk/arcgislink/)

arcgislink.js is modified to decrease the number of digitals after the decimal point. Now the 
latitude and longitude only have six digitals after the decimal point. The length of URL is decreased 
to make sure when buffer circle is combined with other conditions, the application is still working. 

Aug 23, 2013: arcgislink.js is modified to get ride the dependency on google maps by adding a global variable
dependOnGoogleMaps. If this is true, Google Maps will be initialized. Otherwise, this is purely used to generate report. 
*/

(function(){var gmaps=gmaps||{};var RAD_DEG=Math.PI/180;var jsonpID_=0;window.ags_jsonp=window.ags_jsonp||{};var G={OverlayView:function(){},event:{trigger:function(){}}};if(dependOnGoogleMaps){G=google.maps}var WGS84,NAD83,WEB_MERCATOR,WEB_MERCATOR_AUX;var Config={proxyUrl:null,alwaysUseProxy:false};var spatialReferences_={};var Util={};function extractString_(full,start,end){var i=(start==="")?0:full.indexOf(start);var e=end===""?full.length:full.indexOf(end,i+start.length);return full.substring(i+start.length,e)}function isString_(o){return o&&typeof o==="string"}function isArray_(o){return o&&o.splice}function isNumber_(o){return typeof o==="number"}function augmentObject_(src,dest,force){if(src&&dest){var p;for(p in src){if(force||!(p in dest)){dest[p]=src[p]}}}return dest}function triggerEvent_(src,evtName,args){G.event.trigger.apply(this,arguments)}function handleErr_(errback,json){if(errback&&json&&json.error){errback(json.error)}}function formatTimeString_(time,endTime){var ret="";if(time){ret+=(time.getTime()-time.getTimezoneOffset()*60000)}if(endTime){ret+=", "+(endTime.getTime()-endTime.getTimezoneOffset()*60000)}return ret}function setNodeOpacity_(node,op){op=Math.min(Math.max(op,0),1);if(node){var st=node.style;if(typeof st.opacity!=="undefined"){st.opacity=op}if(typeof st.filters!=="undefined"){st.filters.alpha.opacity=Math.floor(100*op)}if(typeof st.filter!=="undefined"){st.filter="alpha(opacity:"+Math.floor(op*100)+")"}}}function getLayerDefsString_(defs){var strDefs="";for(var x in defs){if(defs.hasOwnProperty(x)){if(strDefs.length>0){strDefs+=";"}strDefs+=(x+":"+defs[x])}}return strDefs}function getXmlHttp_(){if(typeof XMLHttpRequest==="undefined"){try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(e1){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(e2){}throw new Error("This browser does not support XMLHttpRequest.")}else{return new XMLHttpRequest()}}var GeometryType={POINT:"esriGeometryPoint",MULTIPOINT:"esriGeometryMultipoint",POLYLINE:"esriGeometryPolyline",POLYGON:"esriGeometryPolygon",ENVELOPE:"esriGeometryEnvelope"};function getGeometryType_(obj){var o=obj;if(isArray_(obj)&&obj.length>0){o=obj[0]}if(o instanceof G.LatLng||o instanceof G.Marker){if(isArray_(obj)&&obj.length>1){return GeometryType.MULTIPOINT}else{return GeometryType.POINT}}else{if(o instanceof G.Polyline){return GeometryType.POLYLINE}else{if(o instanceof G.Polygon){return GeometryType.POLYGON}else{if(o instanceof G.LatLngBounds){return GeometryType.ENVELOPE}else{if(o.x!==undefined&&o.y!==undefined){return GeometryType.POINT}else{if(o.points){return GeometryType.MULTIPOINT}else{if(o.paths){return GeometryType.POLYLINE}else{if(o.rings){return GeometryType.POLYGON}}}}}}}}return null}function isOverlay_(obj){var o=obj;if(isArray_(obj)&&obj.length>0){o=obj[0]}if(isArray_(o)&&o.length>0){o=o[0]}if(o instanceof G.LatLng||o instanceof G.Marker||o instanceof G.Polyline||o instanceof G.Polygon||o instanceof G.LatLngBounds){return true}return false}function formatSRParam_(sr){if(!sr){return null}return isNumber_(sr)?sr:sr.wkid?sr.wkid:sr.toJSON()}function fromLatLngsToJSON_(pts,close){var arr=[];var latlng;for(var i=0,c=pts.getLength();i<c;i++){latlng=pts.getAt(i);arr.push("["+latlng.lng().toFixed(6)+","+latlng.lat().toFixed(6)+"]")}if(close&&arr.length>0){arr.push("["+pts.getAt(0).lng().toFixed(6)+","+pts.getAt(0).lat().toFixed(6)+"]")}return arr.join(",")}function fromOverlaysToJSON_(geom){var gtype=getGeometryType_(geom);var g,gs,i,pts;var json="{";switch(gtype){case GeometryType.POINT:g=isArray_(geom)?geom[0]:geom;if(g instanceof G.Marker){g=g.getPosition()}json+="x:"+g.lng()+",y:"+g.lat();break;case GeometryType.MULTIPOINT:pts=[];for(i=0;i<geom.length;i++){if(geom[i] instanceof G.Marker){g=geom[i].getPosition()}else{g=geom[i]}pts.push("["+g.lng()+","+g.lat()+"]")}json+="points: ["+pts.join(",")+"]";break;case GeometryType.POLYLINE:pts=[];gs=isArray_(geom)?geom:[geom];for(i=0;i<gs.length;i++){pts.push("["+fromLatLngsToJSON_(gs[i].getPath())+"]")}json+="paths:["+pts.join(",")+"]";break;case GeometryType.POLYGON:pts=[];g=isArray_(geom)?geom[0]:geom;var paths=g.getPaths();for(i=0;i<paths.getLength();i++){pts.push("["+fromLatLngsToJSON_(paths.getAt(i),true)+"]")}json+="rings:["+pts.join(",")+"]";break;case GeometryType.ENVELOPE:g=isArray_(geom)?geom[0]:geom;json+="xmin:"+g.getSouthWest().lng()+",ymin:"+g.getSouthWest().lat()+",xmax:"+g.getNorthEast().lng()+",ymax:"+g.getNorthEast().lat();break}json+=", spatialReference:{wkid:4326}";json+="}";return json}function fromGeometryToJSON_(geom){function fromPointsToJSON(pts){var arr=[];for(var i=0,c=pts.length;i<c;i++){arr.push("["+pts[i][0]+","+pts[i][1]+"]")}return"["+arr.join(",")+"]"}function fromLinesToJSON(lines){var arr=[];for(var i=0,c=lines.length;i<c;i++){arr.push(fromPointsToJSON(lines[i]))}return"["+arr.join(",")+"]"}var json="{";if(geom.x){json+="x:"+geom.x+",y:"+geom.y}else{if(geom.xmin){json+="xmin:"+geom.xmin+",ymin:"+geom.ymin+",xmax:"+geom.xmax+",ymax:"+geom.ymax}else{if(geom.points){json+="points:"+fromPointsToJSON(geom.points)}else{if(geom.paths){json+="paths:"+fromLinesToJSON(geom.paths)}else{if(geom.rings){json+="rings:"+fromLinesToJSON(geom.rings)}}}}}json+="}";return json}function fromEnvelopeToLatLngBounds_(extent){var sr=spatialReferences_[extent.spatialReference.wkid||extent.spatialReference.wkt];sr=sr||WGS84;var sw=sr.inverse([extent.xmin,extent.ymin]);var ne=sr.inverse([extent.xmax,extent.ymax]);return new G.LatLngBounds(new G.LatLng(sw[1],sw[0]),new G.LatLng(ne[1],ne[0]))}function fromJSONToOverlays_(geom,opts){var ovs=null;var ov;var i,ic,j,jc,parts,part,lnglat,latlngs;opts=opts||{};if(geom){ovs=[];if(geom.x){ov=new G.Marker(augmentObject_(opts.markerOptions||opts,{position:new G.LatLng(geom.y,geom.x)}));ovs.push(ov)}else{parts=geom.points||geom.paths||geom.rings;if(!parts){return ovs}var rings=[];for(i=0,ic=parts.length;i<ic;i++){part=parts[i];if(geom.points){ov=new G.Marker(augmentObject_(opts.markerOptions||opts,{position:new G.LatLng(part[1],part[0])}));ovs.push(ov)}else{latlngs=[];for(j=0,jc=part.length;j<jc;j++){lnglat=part[j];latlngs.push(new G.LatLng(lnglat[1],lnglat[0]))}if(geom.paths){ov=new G.Polyline(augmentObject_(opts.polylineOptions||opts,{path:latlngs}));ovs.push(ov)}else{if(geom.rings){rings.push(latlngs)}}}}if(geom.rings){ov=new G.Polygon(augmentObject_(opts.polygonOptions||opts,{paths:rings}));ovs.push(ov)}}}return ovs}function parseFeatures_(features,ovOpts){if(features){var i,I,f;for(i=0,I=features.length;i<I;i++){f=features[i];if(f.geometry){f.geometry=fromJSONToOverlays_(f.geometry,ovOpts)}}}}function formatRequestString_(o){var ret;if(typeof o==="object"){if(isArray_(o)){ret=[];for(var i=0,I=o.length;i<I;i++){ret.push(formatRequestString_(o[i]))}return"["+ret.join(",")+"]"}else{if(isOverlay_(o)){return fromOverlaysToJSON_(o)}else{if(o.toJSON){return o.toJSON()}else{ret="";for(var x in o){if(o.hasOwnProperty(x)){if(ret.length>0){ret+=", "}ret+=x+":"+formatRequestString_(o[x])}}return"{"+ret+"}"}}}}return o.toString()}function fromLatLngsToFeatureSet_(latlngs){var i,I,latlng;var features=[];for(i=0,I=latlngs.length;i<I;i++){latlng=latlngs[i];if(latlng instanceof G.Marker){latlng=latlng.getPosition()}features.push({geometry:{x:latlng.lng(),y:latlng.lat(),spatialReference:{wkid:4326}}})}return{type:'"features"',features:features,doNotLocateOnRestrictedElements:false}}function prepareGeometryParams_(p){var params={};if(!p){return null}var json=[];var g,isOv;if(p.geometries&&p.geometries.length>0){g=p.geometries[0];isOv=isOverlay_(g);for(var i=0,c=p.geometries.length;i<c;i++){if(isOv){json.push(fromOverlaysToJSON_(p.geometries[i]))}else{json.push(fromGeometryToJSON_(p.geometries[i]))}}}if(!p.geometryType){p.geometryType=getGeometryType_(g)}if(isOv){params.inSR=WGS84.wkid}else{if(p.inSpatialReference){params.inSR=formatSRParam_(p.inSpatialReference)}}if(p.outSpatialReference){params.outSR=formatSRParam_(p.outSpatialReference)}params.geometries='{geometryType:"'+p.geometryType+'", geometries:['+json.join(",")+"]}";return params}function log_(msg){if(window.console){window.console.log(msg)}else{var l=document.getElementById("_ags_log");if(l){l.innerHTML=l.innerHTML+msg+"<br/>"}}}function formatParams_(params){var query="";if(params){params.f=params.f||"json";for(var x in params){if(params.hasOwnProperty(x)&&params[x]!==null&&params[x]!==undefined){var val=formatRequestString_(params[x]);query+=(query.length>0?"&":"")+(x+"="+(escape?escape(val):encodeURIComponent(val)))}}}return query}function callback_(fn,obj){var args=[];for(var i=2,c=arguments.length;i<c;i++){args.push(arguments[i])}return function(){fn.apply(obj,args)}}function addCopyrightInfo_(cpArray,mapService,map){if(mapService.hasLoaded()){cpArray.push(mapService.copyrightText)}else{G.event.addListenerOnce(mapService,"load",function(){setCopyrightInfo_(map)})}}function setCopyrightInfo_(map){var div=null;if(map){var mvc=map.controls[G.ControlPosition.BOTTOM_RIGHT];if(mvc){for(var i=0,c=mvc.getLength();i<c;i++){if(mvc.getAt(i).id==="agsCopyrights"){div=mvc.getAt(i);break}}}if(!div){div=document.createElement("div");div.style.fontFamily="Arial,sans-serif";div.style.fontSize="10px";div.style.textAlign="right";div.id="agsCopyrights";map.controls[G.ControlPosition.BOTTOM_RIGHT].push(div);G.event.addListener(map,"maptypeid_changed",function(){setCopyrightInfo_(map)})}var ovs=map.agsOverlays;var cp=[];var svc,type;if(ovs){for(var i=0,c=ovs.getLength();i<c;i++){addCopyrightInfo_(cp,ovs.getAt(i).mapService_,map)}}var ovTypes=map.overlayMapTypes;if(ovTypes){for(var i=0,c=ovTypes.getLength();i<c;i++){type=ovTypes.getAt(i);if(type instanceof MapType){for(var j=0,cj=type.tileLayers_.length;j<cj;j++){addCopyrightInfo_(cp,type.tileLayers_[j].mapService_,map)}}}}type=map.mapTypes.get(map.getMapTypeId());if(type instanceof MapType){for(var i=0,c=type.tileLayers_.length;i<c;i++){addCopyrightInfo_(cp,type.tileLayers_[i].mapService_,map)}if(type.negative){div.style.color="#ffffff"}else{div.style.color="#000000"}}div.innerHTML=cp.join("<br/>")}}function getJSON_(url,params,callbackName,callbackFn){var sid="ags_jsonp_"+(jsonpID_++)+"_"+Math.floor(Math.random()*1000000);var script=null;params=params||{};params[callbackName||"callback"]="ags_jsonp."+sid;var query=formatParams_(params);var head=document.getElementsByTagName("head")[0];if(!head){throw new Error("document must have header tag")}var jsonpcallback=function(){if(window.ags_jsonp[sid]){delete window.ags_jsonp[sid]}if(script){head.removeChild(script)}script=null;callbackFn.apply(null,arguments);triggerEvent_(Util,"jsonpend",sid)};window.ags_jsonp[sid]=jsonpcallback;if((query+url).length<2000&&!Config.alwaysUseProxy){script=document.createElement("script");script.src=url+(url.indexOf("?")===-1?"?":"&")+query;script.id=sid;head.appendChild(script)}else{var loc=window.location;var dom=loc.protocol+"//"+loc.hostname+(!loc.port||loc.port===80?"":":"+loc.port+"/");var useProxy=true;if(url.toLowerCase().indexOf(dom.toLowerCase())!==-1){useProxy=false}if(Config.alwaysUseProxy){useProxy=true}if(useProxy&&!Config.proxyUrl){throw new Error("No proxyUrl property in Config is defined")}var xmlhttp=getXmlHttp_();xmlhttp.onreadystatechange=function(){if(xmlhttp.readyState===4){if(xmlhttp.status===200){eval(xmlhttp.responseText)}else{throw new Error("Error code "+xmlhttp.status)}}};xmlhttp.open("POST",useProxy?Config.proxyUrl+"?"+url:url,true);xmlhttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded");xmlhttp.send(query)}triggerEvent_(Util,"jsonpstart",sid);return sid}Util.getJSON=function(url,params,callbackName,callbackFn){getJSON_(url,params,callbackName,callbackFn)};Util.addToMap=function(map,overlays){if(isArray_(overlays)){var ov;for(var i=0,I=overlays.length;i<I;i++){ov=overlays[i];if(isArray_(ov)){Util.addToMap(map,ov)}else{if(isOverlay_(ov)){ov.setMap(map)}}}}};Util.removeFromMap=function(overlays,clearArray){Util.addToMap(null,overlays);if(clearArray){overlays.length=0}};function SpatialReference(params){params=params||{};this.wkid=params.wkid;this.wkt=params.wkt}SpatialReference.prototype.forward=function(lnglat){return lnglat};SpatialReference.prototype.inverse=function(coords){return coords};SpatialReference.prototype.getCircum=function(){return 360};SpatialReference.prototype.toJSON=function(){return"{"+(this.wkid?" wkid:"+this.wkid:"wkt: '"+this.wkt+"'")+"}"};function Geographic(params){params=params||{};SpatialReference.call(this,params)}Geographic.prototype=new SpatialReference();function LambertConformalConic(params){params=params||{};SpatialReference.call(this,params);var f_i=params.inverse_flattening;var phi1=params.standard_parallel_1*RAD_DEG;var phi2=params.standard_parallel_2*RAD_DEG;var phi0=params.latitude_of_origin*RAD_DEG;this.a_=params.semi_major/params.unit;this.lamda0_=params.central_meridian*RAD_DEG;this.FE_=params.false_easting;this.FN_=params.false_northing;var f=1/f_i;var es=2*f-f*f;this.e_=Math.sqrt(es);var m1=this.calc_m_(phi1,es);var m2=this.calc_m_(phi2,es);var tF=this.calc_t_(phi0,this.e_);var t1=this.calc_t_(phi1,this.e_);var t2=this.calc_t_(phi2,this.e_);this.n_=Math.log(m1/m2)/Math.log(t1/t2);this.F_=m1/(this.n_*Math.pow(t1,this.n_));this.rho0_=this.calc_rho_(this.a_,this.F_,tF,this.n_)}LambertConformalConic.prototype=new SpatialReference();LambertConformalConic.prototype.calc_m_=function(phi,es){var sinphi=Math.sin(phi);return Math.cos(phi)/Math.sqrt(1-es*sinphi*sinphi)};LambertConformalConic.prototype.calc_t_=function(phi,e){var esp=e*Math.sin(phi);return Math.tan(Math.PI/4-phi/2)/Math.pow((1-esp)/(1+esp),e/2)};LambertConformalConic.prototype.calc_rho_=function(a,F,t,n){return a*F*Math.pow(t,n)};LambertConformalConic.prototype.calc_phi_=function(t,e,phi){var esp=e*Math.sin(phi);return Math.PI/2-2*Math.atan(t*Math.pow((1-esp)/(1+esp),e/2))};LambertConformalConic.prototype.solve_phi_=function(t_i,e,init){var i=0;var phi=init;var newphi=this.calc_phi_(t_i,e,phi);while(Math.abs(newphi-phi)>1e-9&&i<10){i++;phi=newphi;newphi=this.calc_phi_(t_i,e,phi)}return newphi};LambertConformalConic.prototype.forward=function(lnglat){var phi=lnglat[1]*RAD_DEG;var lamda=lnglat[0]*RAD_DEG;var t=this.calc_t_(phi,this.e_);var rho=this.calc_rho_(this.a_,this.F_,t,this.n_);var theta=this.n_*(lamda-this.lamda0_);var E=this.FE_+rho*Math.sin(theta);var N=this.FN_+this.rho0_-rho*Math.cos(theta);return[E,N]};LambertConformalConic.prototype.inverse=function(coords){var E=coords[0]-this.FE_;var N=coords[1]-this.FN_;var theta=Math.atan(E/(this.rho0_-N));var rho=(this.n_>0?1:-1)*Math.sqrt(E*E+(this.rho0_-N)*(this.rho0_-N));var t=Math.pow((rho/(this.a_*this.F_)),1/this.n_);var init=Math.PI/2-2*Math.atan(t);var phi=this.solve_phi_(t,this.e_,init);var lamda=theta/this.n_+this.lamda0_;return[lamda/RAD_DEG,phi/RAD_DEG]};LambertConformalConic.prototype.getCircum=function(){return Math.PI*2*this.a_};function TransverseMercator(params){params=params||{};SpatialReference.call(this,params);this.a_=params.semi_major/params.unit;var f_i=params.inverse_flattening;this.k0_=params.scale_factor;var phi0=params.latitude_of_origin*RAD_DEG;this.lamda0_=params.central_meridian*RAD_DEG;this.FE_=params.false_easting;this.FN_=params.false_northing;var f=1/f_i;this.es_=2*f-f*f;this.ep4_=this.es_*this.es_;this.ep6_=this.ep4_*this.es_;this.eas_=this.es_/(1-this.es_);this.M0_=this.calc_m_(phi0,this.a_,this.es_,this.ep4_,this.ep6_)}TransverseMercator.prototype=new SpatialReference();TransverseMercator.prototype.calc_m_=function(phi,a,es,ep4,ep6){return a*((1-es/4-3*ep4/64-5*ep6/256)*phi-(3*es/8+3*ep4/32+45*ep6/1024)*Math.sin(2*phi)+(15*ep4/256+45*ep6/1024)*Math.sin(4*phi)-(35*ep6/3072)*Math.sin(6*phi))};TransverseMercator.prototype.forward=function(lnglat){var phi=lnglat[1]*RAD_DEG;var lamda=lnglat[0]*RAD_DEG;var nu=this.a_/Math.sqrt(1-this.es_*Math.pow(Math.sin(phi),2));var T=Math.pow(Math.tan(phi),2);var C=this.eas_*Math.pow(Math.cos(phi),2);var A=(lamda-this.lamda0_)*Math.cos(phi);var M=this.calc_m_(phi,this.a_,this.es_,this.ep4_,this.ep6_);var E=this.FE_+this.k0_*nu*(A+(1-T+C)*Math.pow(A,3)/6+(5-18*T+T*T+72*C-58*this.eas_)*Math.pow(A,5)/120);var N=this.FN_+this.k0_*(M-this.M0_)+nu*Math.tan(phi)*(A*A/2+(5-T+9*C+4*C*C)*Math.pow(A,4)/120+(61-58*T+T*T+600*C-330*this.eas_)*Math.pow(A,6)/720);return[E,N]};TransverseMercator.prototype.inverse=function(coords){var E=coords[0];var N=coords[1];var e1=(1-Math.sqrt(1-this.es_))/(1+Math.sqrt(1-this.es_));var M1=this.M0_+(N-this.FN_)/this.k0_;var mu1=M1/(this.a_*(1-this.es_/4-3*this.ep4_/64-5*this.ep6_/256));var phi1=mu1+(3*e1/2-27*Math.pow(e1,3)/32)*Math.sin(2*mu1)+(21*e1*e1/16-55*Math.pow(e1,4)/32)*Math.sin(4*mu1)+(151*Math.pow(e1,3)/6)*Math.sin(6*mu1)+(1097*Math.pow(e1,4)/512)*Math.sin(8*mu1);var C1=this.eas_*Math.pow(Math.cos(phi1),2);var T1=Math.pow(Math.tan(phi1),2);var N1=this.a_/Math.sqrt(1-this.es_*Math.pow(Math.sin(phi1),2));var R1=this.a_*(1-this.es_)/Math.pow((1-this.es_*Math.pow(Math.sin(phi1),2)),3/2);var D=(E-this.FE_)/(N1*this.k0_);var phi=phi1-(N1*Math.tan(phi1)/R1)*(D*D/2-(5+3*T1+10*C1-4*C1*C1-9*this.eas_)*Math.pow(D,4)/24+(61+90*T1+28*C1+45*T1*T1-252*this.eas_-3*C1*C1)*Math.pow(D,6)/720);var lamda=this.lamda0_+(D-(1+2*T1+C1)*Math.pow(D,3)/6+(5-2*C1+28*T1-3*C1*C1+8*this.eas_+24*T1*T1)*Math.pow(D,5)/120)/Math.cos(phi1);return[lamda/RAD_DEG,phi/RAD_DEG]};TransverseMercator.prototype.getCircum=function(){return Math.PI*2*this.a_};function SphereMercator(params){params=params||{};SpatialReference.call(this,params);this.a_=(params.semi_major||6378137)/(params.unit||1);this.lamda0_=(params.central_meridian||0)*RAD_DEG}SphereMercator.prototype=new SpatialReference();SphereMercator.prototype.forward=function(lnglat){var phi=lnglat[1]*RAD_DEG;var lamda=lnglat[0]*RAD_DEG;var E=this.a_*(lamda-this.lamda0_);var N=(this.a_/2)*Math.log((1+Math.sin(phi))/(1-Math.sin(phi)));return[E,N]};SphereMercator.prototype.inverse=function(coords){var E=coords[0];var N=coords[1];var phi=Math.PI/2-2*Math.atan(Math.exp(-N/this.a_));var lamda=E/this.a_+this.lamda0_;return[lamda/RAD_DEG,phi/RAD_DEG]};SphereMercator.prototype.getCircum=function(){return Math.PI*2*this.a_};function Albers(params){params=params||{};SpatialReference.call(this,params);var f_i=params.inverse_flattening;var phi1=params.standard_parallel_1*RAD_DEG;var phi2=params.standard_parallel_2*RAD_DEG;var phi0=params.latitude_of_origin*RAD_DEG;this.a_=params.semi_major/params.unit;this.lamda0_=params.central_meridian*RAD_DEG;this.FE_=params.false_easting;this.FN_=params.false_northing;var f=1/f_i;var es=2*f-f*f;this.e_=Math.sqrt(es);var m1=this.calc_m_(phi1,es);var m2=this.calc_m_(phi2,es);var q1=this.calc_q_(phi1,this.e_);var q2=this.calc_q_(phi2,this.e_);var q0=this.calc_q_(phi0,this.e_);this.n_=(m1*m1-m2*m2)/(q2-q1);this.C_=m1*m1+this.n_*q1;this.rho0_=this.calc_rho_(this.a_,this.C_,this.n_,q0)}Albers.prototype=new SpatialReference();Albers.prototype.calc_m_=function(phi,es){var sinphi=Math.sin(phi);return Math.cos(phi)/Math.sqrt(1-es*sinphi*sinphi)};Albers.prototype.calc_q_=function(phi,e){var esp=e*Math.sin(phi);return(1-e*e)*(Math.sin(phi)/(1-esp*esp)-(1/(2*e))*Math.log((1-esp)/(1+esp)))};Albers.prototype.calc_rho_=function(a,C,n,q){return a*Math.sqrt(C-n*q)/n};Albers.prototype.calc_phi_=function(q,e,phi){var esp=e*Math.sin(phi);return phi+(1-esp*esp)*(1-esp*esp)/(2*Math.cos(phi))*(q/(1-e*e)-Math.sin(phi)/(1-esp*esp)+Math.log((1-esp)/(1+esp))/(2*e))};Albers.prototype.solve_phi_=function(q,e,init){var i=0;var phi=init;var newphi=this.calc_phi_(q,e,phi);while(Math.abs(newphi-phi)>1e-8&&i<10){i++;phi=newphi;newphi=this.calc_phi_(q,e,phi)}return newphi};Albers.prototype.forward=function(lnglat){var phi=lnglat[1]*RAD_DEG;var lamda=lnglat[0]*RAD_DEG;var q=this.calc_q_(phi,this.e_);var rho=this.calc_rho_(this.a_,this.C_,this.n_,q);var theta=this.n_*(lamda-this.lamda0_);var E=this.FE_+rho*Math.sin(theta);var N=this.FN_+this.rho0_-rho*Math.cos(theta);return[E,N]};Albers.prototype.inverse=function(coords){var E=coords[0]-this.FE_;var N=coords[1]-this.FN_;var rho=Math.sqrt(E*E+(this.rho0_-N)*(this.rho0_-N));var adj=this.n_>0?1:-1;var theta=Math.atan(adj*E/(adj*this.rho0_-adj*N));var q=(this.C_-rho*rho*this.n_*this.n_/(this.a_*this.a_))/this.n_;var init=Math.asin(q/2);var phi=this.solve_phi_(q,this.e_,init);var lamda=theta/this.n_+this.lamda0_;return[lamda/RAD_DEG,phi/RAD_DEG]};Albers.prototype.getCircum=function(){return Math.PI*2*this.a_};Albers.prototype.getCircum=function(){return Math.PI*2*this.a_};WGS84=new Geographic({wkid:4326});NAD83=new Geographic({wkid:4269});WEB_MERCATOR=new SphereMercator({wkid:102113,semi_major:6378137,central_meridian:0,unit:1});WEB_MERCATOR_AUX=new SphereMercator({wkid:102100,semi_major:6378137,central_meridian:0,unit:1});spatialReferences_={"4326":WGS84,"4269":NAD83,"102113":WEB_MERCATOR,"102100":WEB_MERCATOR_AUX};SpatialReference.WGS84=WGS84;SpatialReference.NAD83=NAD83;SpatialReference.WEB_MERCATOR=WEB_MERCATOR;SpatialReference.WEB_MERCATOR_AUX=WEB_MERCATOR_AUX;Util.registerSR=function(wkidt,wktOrSR){var sr=spatialReferences_[""+wkidt];if(sr){return sr}if(wktOrSR instanceof SpatialReference){spatialReferences_[""+wkidt]=wktOrSR;sr=wktOrSR}else{var wkt=wktOrSR||wkidt;var params={wkt:wkidt};if(wkidt===parseInt(wkidt,10)){params={wkid:wkidt}}var prj=extractString_(wkt,'PROJECTION["','"]');var spheroid=extractString_(wkt,"SPHEROID[","]").split(",");if(prj!==""){params.unit=parseFloat(extractString_(extractString_(wkt,"PROJECTION",""),"UNIT[","]").split(",")[1]);params.semi_major=parseFloat(spheroid[1]);params.inverse_flattening=parseFloat(spheroid[2]);params.latitude_of_origin=parseFloat(extractString_(wkt,'"Latitude_Of_Origin",',"]"));params.central_meridian=parseFloat(extractString_(wkt,'"Central_Meridian",',"]"));params.false_easting=parseFloat(extractString_(wkt,'"False_Easting",',"]"));params.false_northing=parseFloat(extractString_(wkt,'"False_Northing",',"]"))}switch(prj){case"":sr=new SpatialReference(params);break;case"Lambert_Conformal_Conic":params.standard_parallel_1=parseFloat(extractString_(wkt,'"Standard_Parallel_1",',"]"));params.standard_parallel_2=parseFloat(extractString_(wkt,'"Standard_Parallel_2",',"]"));sr=new LambertConformalConic(params);break;case"Transverse_Mercator":params.scale_factor=parseFloat(extractString_(wkt,'"Scale_Factor",',"]"));sr=new TransverseMercator(params);break;case"Albers":params.standard_parallel_1=parseFloat(extractString_(wkt,'"Standard_Parallel_1",',"]"));params.standard_parallel_2=parseFloat(extractString_(wkt,'"Standard_Parallel_2",',"]"));sr=new Albers(params);break;default:throw new Error(prj+"  not supported")}if(sr){spatialReferences_[""+wkidt]=sr}}return sr};function Catalog(url){this.url=url;var me=this;getJSON_(url,{},"",function(json){augmentObject_(json,me);triggerEvent_(me,"load")})}function Layer(url){this.url=url;this.definition=null}Layer.prototype.load=function(){var me=this;if(this.loaded_){return}getJSON_(this.url,{},"",function(json){augmentObject_(json,me);me.loaded_=true;triggerEvent_(me,"load")})};Layer.prototype.isInScale=function(scale){if(this.maxScale&&this.maxScale>scale){return false}if(this.minScale&&this.minScale<scale){return false}return true};var SpatialRelationship={INTERSECTS:"esriSpatialRelIntersects",CONTAINS:"esriSpatialRelContains",CROSSES:"esriSpatialRelCrosses",ENVELOPE_INTERSECTS:"esriSpatialRelEnvelopeIntersects",INDEX_INTERSECTS:"esriSpatialRelIndexIntersects",OVERLAPS:"esriSpatialRelOverlaps",TOUCHES:"esriSpatialRelTouches",WITHIN:"esriSpatialRelWithin"};Layer.prototype.query=function(p,callback,errback){if(!p){return}var params=augmentObject_(p,{});if(p.geometry&&!isString_(p.geometry)){params.geometry=fromOverlaysToJSON_(p.geometry);params.geometryType=getGeometryType_(p.geometry);params.inSR=4326}if(p.spatialRelationship){params.spatialRel=p.spatialRelationship;delete params.spatialRelationship}if(p.outFields&&isArray_(p.outFields)){params.outFields=p.outFields.join(",")}if(p.objectIds){params.objectIds=p.objectIds.join(",")}if(p.time){params.time=formatTimeString_(p.time,p.endTime)}params.outSR=4326;params.returnGeometry=p.returnGeometry===false?false:true;params.returnIdsOnly=p.returnIdsOnly===true?true:false;delete params.overlayOptions;getJSON_(this.url+"/query",params,"",function(json){parseFeatures_(json.features,p.overlayOptions);callback(json,json.error);handleErr_(errback,json)})};Layer.prototype.queryRelatedRecords=function(qparams,callback,errback){if(!qparams){return}var params=augmentObject_(qparams,{});params.f=params.f||"json";if(params.outFields&&!isString_(params.outFields)){params.outFields=params.outFields.join(",")}params.returnGeometry=params.returnGeometry===false?false:true;getJSON_(this.url+"/query",params,"",function(json){handleErr_(errback,json);callback(json)})};function MapService(url,opts){this.url=url;this.loaded_=false;var tks=url.split("/");this.name=tks[tks.length-2].replace(/_/g," ");opts=opts||{};if(opts.delayLoad){var me=this;window.setTimeout(function(){me.loadServiceInfo()},opts.delayLoad*1000)}else{this.loadServiceInfo()}}MapService.prototype.loadServiceInfo=function(){var me=this;getJSON_(this.url,{},"",function(json){me.init_(json)})};MapService.prototype.init_=function(json){var me=this;if(json.error){throw new Error(json.error.message)}augmentObject_(json,this);if(json.spatialReference.wkt){this.spatialReference=Util.registerSR(json.spatialReference.wkt)}else{this.spatialReference=spatialReferences_[json.spatialReference.wkid]}if(json.tables!==undefined){getJSON_(this.url+"/layers",{},"",function(json2){me.initLayers_(json2);getJSON_(me.url+"/legend",{},"",function(json3){me.initLegend_(json3);me.setLoaded_()})})}else{me.initLayers_(json);me.setLoaded_()}};MapService.prototype.setLoaded_=function(){this.loaded_=true;triggerEvent_(this,"load")};MapService.prototype.initLayers_=function(json2){var layers=[];var tables=[];this.layers=layers;if(json2.tables){this.tables=tables}var layer,i,c,info;for(i=0,c=json2.layers.length;i<c;i++){info=json2.layers[i];layer=new Layer(this.url+"/"+info.id);augmentObject_(info,layer);layer.visible=layer.defaultVisibility;layers.push(layer)}if(json2.tables){for(i=0,c=json2.tables.length;i<c;i++){info=json2.tables[i];layer=new Layer(this.url+"/"+info.id);augmentObject_(info,layer);tables.push(layer)}}for(i=0,c=layers.length;i<c;i++){layer=layers[i];if(layer.subLayerIds){layer.subLayers=[];for(var j=0,jc=layer.subLayerIds.length;j<jc;j++){var subLayer=this.getLayer(layer.subLayerIds[j]);layer.subLayers.push(subLayer);subLayer.parentLayer=layer}}}};MapService.prototype.initLegend_=function(json3){var layers=this.layers;if(json3.layers){var layer,i,c,info;for(i=0,c=json3.layers.length;i<c;i++){info=json3.layers[i];layer=layers[info.layerId];augmentObject_(info,layer)}}};MapService.prototype.getLayer=function(nameOrId){var layers=this.layers;if(layers){for(var i=0,c=layers.length;i<c;i++){if(nameOrId===layers[i].id){return layers[i]}if(isString_(nameOrId)&&layers[i].name.toLowerCase()===nameOrId.toLowerCase()){return layers[i]}}}return null};MapService.prototype.getLayerDefs_=function(){var ret={};if(this.layers){for(var i=0,c=this.layers.length;i<c;i++){var layer=this.layers[i];if(layer.definition){ret[String(layer.id)]=layer.definition}}}return ret};MapService.prototype.hasLoaded=function(){return this.loaded_};MapService.prototype.getVisibleLayerIds_=function(){var ret=[];if(this.layers){var layer;var i,c;for(i=0,c=this.layers.length;i<c;i++){layer=this.layers[i];if(layer.subLayers){for(var j=0,jc=layer.subLayers.length;j<jc;j++){if(layer.subLayers[j].visible===false){layer.visible=false;break}}}}for(i=0,c=this.layers.length;i<c;i++){layer=this.layers[i];if(layer.subLayers&&layer.subLayers.length>0){continue}if(layer.visible===true){ret.push(layer.id)}}}return ret};MapService.prototype.getInitialBounds=function(){if(this.initialExtent){this.initBounds_=this.initBounds_||fromEnvelopeToLatLngBounds_(this.initialExtent);return this.initBounds_}return null};MapService.prototype.getFullBounds=function(){if(this.fullExtent){this.fullBounds_=this.fullBounds_||fromEnvelopeToLatLngBounds_(this.fullExtent);return this.fullBounds_}return null};MapService.prototype.exportMap=function(p,callback,errback){if(!p||!p.bounds){return}var params={};params.f=p.f;var bnds=p.bounds;params.bbox=""+bnds.getSouthWest().lng()+","+bnds.getSouthWest().lat()+","+bnds.getNorthEast().lng()+","+bnds.getNorthEast().lat();params.size=""+p.width+","+p.height;params.dpi=p.dpi;if(p.imageSR){if(p.imageSR.wkid){params.imageSR=p.imageSR.wkid}else{params.imageSR="{wkt:"+p.imageSR.wkt+"}"}}params.bboxSR="4326";params.format=p.format;var defs=p.layerDefinitions;if(defs===undefined){defs=this.getLayerDefs_()}params.layerDefs=getLayerDefsString_(defs);var vlayers=p.layerIds;var layerOpt=p.layerOption||"show";if(vlayers===undefined){vlayers=this.getVisibleLayerIds_()}if(vlayers.length>0){params.layers=layerOpt+":"+vlayers.join(",")}else{if(this.loaded_&&callback){callback({href:null});return}}params.transparent=(p.transparent===false?false:true);if(p.time){params.time=formatTimeString_(p.time,p.endTime)}params.layerTimeOptions=p.layerTimeOptions;if(params.f==="image"){return this.url+"/export?"+formatParams_(params)}else{getJSON_(this.url+"/export",params,"",function(json){if(json.extent){json.bounds=fromEnvelopeToLatLngBounds_(json.extent);delete json.extent;callback(json)}else{handleErr_(errback,json.error)}})}};MapService.prototype.identify=function(p,callback,errback){if(!p){return}var params={};params.geometry=fromOverlaysToJSON_(p.geometry);params.geometryType=getGeometryType_(p.geometry);params.mapExtent=fromOverlaysToJSON_(p.bounds);params.tolerance=p.tolerance||2;params.sr=4326;params.imageDisplay=""+p.width+","+p.height+","+(p.dpi||96);params.layers=(p.layerOption||"all");if(p.layerIds){params.layers+=":"+p.layerIds.join(",")}if(p.layerDefs){params.layerDefs=getLayerDefsString_(p.layerDefs)}params.maxAllowableOffset=p.maxAllowableOffset;params.returnGeometry=(p.returnGeometry===false?false:true);getJSON_(this.url+"/identify",params,"",function(json){var rets=null;var i,js,g;if(json.results){rets=[];for(i=0;i<json.results.length;i++){js=json.results[i];g=fromJSONToOverlays_(js.geometry,p.overlayOptions);js.feature={geometry:g,attributes:js.attributes};delete js.attributes}}callback(json);handleErr_(errback,json)})};MapService.prototype.find=function(opts,callback,errback){if(!opts){return}var params=augmentObject_(opts,{});if(opts.layerIds){params.layers=opts.layerIds.join(",");delete params.layerIds}if(opts.searchFields){params.searchFields=opts.searchFields.join(",")}params.contains=(opts.contains===false?false:true);if(opts.layerDefinitions){params.layerDefs=getLayerDefsString_(opts.layerDefinitions);delete params.layerDefinitions}params.sr=4326;params.returnGeometry=(opts.returnGeometry===false?false:true);getJSON_(this.url+"/find",params,"",function(json){var rets=null;var i,js,g;if(json.results){rets=[];for(i=0;i<json.results.length;i++){js=json.results[i];g=fromJSONToOverlays_(js.geometry,opts.overlayOptions);js.feature={geometry:g,attributes:js.attributes};delete js.attributes}}callback(json);handleErr_(errback,json)})};MapService.prototype.queryLayer=function(layerNameOrId,params,callback,errback){var layer=this.getLayer(layerNameOrId);if(layer){layer.query(params,callback,errback)}};function GeocodeService(url){this.url=url;this.loaded_=false;var me=this;getJSON_(url,{},"",function(json){me.init_(json)})}GeocodeService.prototype.init_=function(json){augmentObject_(json,this);if(json.spatialReference){this.spatialReference=spatialReferences_[json.spatialReference.wkid||json.spatialReference.wkt]||WGS84}this.loaded_=true;triggerEvent_(this,"load")};GeocodeService.prototype.findAddressCandidates=function(gparams,callback,errback){var params=augmentObject_(gparams,{});if(params.inputs){augmentObject_(params.inputs,params);delete params.inputs}if(isArray_(params.outFields)){params.outFields=params.outFields.join(",")}var me=this;getJSON_(this.url+"/findAddressCandidates",params,"",function(json){if(json.candidates){var res,loc;var cands=[];for(var i=0;i<json.candidates.length;i++){res=json.candidates[i];loc=res.location;if(!isNaN(loc.x)&&!isNaN(loc.y)){var ll=[loc.x,loc.y];var sr=me.spatialReference;if(gparams.outSR){sr=spatialReferences_[gparams.outSR]}if(sr){ll=sr.inverse(ll)}res.location=new G.LatLng(ll[1],ll[0]);cands[cands.length]=res}}}callback({candidates:cands});handleErr_(errback,json)})};GeocodeService.prototype.geocode=function(params,callback){this.findAddressCandidates(params,callback)};GeocodeService.prototype.reverseGeocode=function(params,callback,errback){if(!isString_(params.location)){params.location=fromOverlaysToJSON_(params.location)}params.outSR=4326;var me=this;getJSON_(this.url+"/reverseGeocode",params,"",function(json){if(json.location){var loc=json.location;if(!isNaN(loc.x)&&!isNaN(loc.y)){var ll=[loc.x,loc.y];if(me.spatialReference){ll=me.spatialReference.inverse(ll)}json.location=new G.LatLng(ll[1],ll[0])}}callback(json);handleErr_(errback,json)})};function GeometryService(url){this.url=url;this.t="geocodeservice"}GeometryService.prototype.project=function(p,callback,errback){var params=prepareGeometryParams_(p);getJSON_(this.url+"/project",params,"callback",function(json){var geom=[];if(p.outSpatialReference===4326||p.outSpatialReference.wkid===4326){for(var i=0,c=json.geometries.length;i<c;i++){geom.push(fromJSONToOverlays_(json.geometries[i]))}json.geometries=geom}callback(json);handleErr_(errback,json)})};var SRUnit={METER:9001,FOOT:9002,SURVEY_FOOT:9003,SURVEY_MILE:9035,KILLOMETER:9036,RADIAN:9101,DEGREE:9102};GeometryService.prototype.buffer=function(p,callback,errback){var params=prepareGeometryParams_(p);if(p.bufferSpatialReference){params.bufferSR=formatSRParam_(p.bufferSpatialReference)}params.outSR=4326;params.distances=p.distances.join(",");if(p.unit){params.unit=p.unit}getJSON_(this.url+"/buffer",params,"callback",function(json){var geom=[];if(json.geometries){for(var i=0,c=json.geometries.length;i<c;i++){geom.push(fromJSONToOverlays_(json.geometries[i],p.overlayOptions))}}json.geometries=geom;callback(json);handleErr_(errback,json)})};function GPService(url){this.url=url;this.loaded_=false;var me=this;getJSON_(url,{},"",function(json){augmentObject_(json,me);me.loaded_=true;triggerEvent_(me,"load")})}function GPTask(url){this.url=url;this.loaded_=false;var me=this;getJSON_(url,{},"",function(json){augmentObject_(json,me);me.loaded_=true;triggerEvent_(me,"load")})}GPTask.prototype.execute=function(p,callback,errback){var params={};if(p.parameters){augmentObject_(p.parameters,params)}if(p.outSpatialReference){params["env:outSR"]=formatSRParam_(p.outSpatialReference)}else{params["env:outSR"]=4326}if(p.processSpatialReference){params["env:processSR"]=formatSRParam_(p.processSpatialReference)}getJSON_(this.url+"/execute",params,"",function(json){if(json.results){var res,f;for(var i=0;i<json.results.length;i++){res=json.results[i];if(res.dataType==="GPFeatureRecordSetLayer"){for(var j=0,J=res.value.features.length;j<J;j++){f=res.value.features[j];if(f.geometry){f.geometry=fromJSONToOverlays_(f.geometry,p.overlayOptions)}}}}}callback(json);handleErr_(errback,json)})};function NetworkService(url){this.url=url;this.loaded_=false;var me=this;getJSON_(url,{},"",function(json){augmentObject_(json,me);me.loaded_=true;triggerEvent_(me,"load")})}function RouteTask(url){this.url=url}RouteTask.prototype.solve=function(opts,callback,errback){if(!opts){return}var params=augmentObject_(opts,{});if(isArray_(opts.stops)){params.stops=fromLatLngsToFeatureSet_(opts.stops)}if(isArray_(opts.barriers)){if(opts.barriers.length>0){params.barriers=fromLatLngsToFeatureSet_(opts.barriers)}else{delete params.barriers}}params.returnRoutes=(opts.returnRoutes===false?false:true);params.returnDirections=(opts.returnDirections===true?true:false);params.returnBarriers=(opts.returnBarriers===true?true:false);params.returnStops=(opts.returnStops===true?true:false);getJSON_(this.url+"/solve",params,"",function(json){if(json.routes){parseFeatures_(json.routes.features,opts.overlayOptions)}callback(json);handleErr_(errback,json)})};function Projection(tileInfo){this.lods_=tileInfo?tileInfo.lods:null;this.spatialReference_=tileInfo?spatialReferences_[tileInfo.spatialReference.wkid||tileInfo.spatialReference.wkt]:WEB_MERCATOR;if(!this.spatialReference_){throw new Error("unsupported Spatial Reference")}this.resolution0_=tileInfo?tileInfo.lods[0].resolution:156543.033928;this.minZoom=Math.floor(Math.log(this.spatialReference_.getCircum()/this.resolution0_/256)/Math.LN2+0.5);this.maxZoom=tileInfo?this.minZoom+this.lods_.length-1:20;if(G.Size){this.tileSize_=tileInfo?new G.Size(tileInfo.cols,tileInfo.rows):new G.Size(256,256)}this.scale_=Math.pow(2,this.minZoom)*this.resolution0_;this.originX_=tileInfo?tileInfo.origin.x:-20037508.342787;this.originY_=tileInfo?tileInfo.origin.y:20037508.342787;if(tileInfo){var ratio;for(var i=0;i<tileInfo.lods.length-1;i++){ratio=tileInfo.lods[i].resolution/tileInfo.lods[i+1].resolution;if(ratio>2.001||ratio<1.999){throw new Error("This type of map cache is not supported in V3. \nScale ratio between zoom levels must be 2")}}}}Projection.prototype.fromLatLngToPoint=function(latlng,opt_point){if(!latlng||isNaN(latlng.lat())||isNaN(latlng.lng())){return null}var coords=this.spatialReference_.forward([latlng.lng(),latlng.lat()]);var point=opt_point||new G.Point(0,0);point.x=(coords[0]-this.originX_)/this.scale_;point.y=(this.originY_-coords[1])/this.scale_;return point};Projection.prototype.fromLatLngToPoint=Projection.prototype.fromLatLngToPoint;Projection.prototype.fromPointToLatLng=function(pixel,opt_nowrap){if(pixel===null){return null}var x=pixel.x*this.scale_+this.originX_;var y=this.originY_-pixel.y*this.scale_;var geo=this.spatialReference_.inverse([x,y]);return new G.LatLng(geo[1],geo[0])};Projection.prototype.getScale=function(zoom){var zoomIdx=zoom-this.minZoom;var res=0;if(this.lods_[zoomIdx]){res=this.lods_[zoomIdx].scale}return res};Projection.WEB_MECATOR=new Projection();function TileLayer(service,opt_layerOpts){opt_layerOpts=opt_layerOpts||{};if(opt_layerOpts.opacity){this.opacity_=opt_layerOpts.opacity;delete opt_layerOpts.opacity}augmentObject_(opt_layerOpts,this);this.mapService_=(service instanceof MapService)?service:new MapService(service);if(opt_layerOpts.hosts){var pro=extractString_(this.mapService_.url,"","://");var host=extractString_(this.mapService_.url,"://","/");var path=extractString_(this.mapService_.url,pro+"://"+host,"");this.urlTemplate_=pro+"://"+opt_layerOpts.hosts+path;this.numOfHosts_=parseInt(extractString_(opt_layerOpts.hosts,"[","]"),10)}this.name=opt_layerOpts.name||this.mapService_.name;this.maxZoom=opt_layerOpts.maxZoom||19;this.minZoom=opt_layerOpts.minZoom||0;this.dynaZoom=opt_layerOpts.dynaZoom||this.maxZoom;if(this.mapService_.loaded_){this.init_(opt_layerOpts)}else{var me=this;G.event.addListenerOnce(this.mapService_,"load",function(){me.init_(opt_layerOpts)})}this.tiles_={};this.map_=opt_layerOpts.map}TileLayer.prototype.init_=function(opt_layerOpts){if(this.mapService_.tileInfo){this.projection_=new Projection(this.mapService_.tileInfo);this.minZoom=opt_layerOpts.minZoom||this.projection_.minZoom;this.maxZoom=opt_layerOpts.maxZoom||this.projection_.maxZoom}};TileLayer.prototype.getTileUrl=function(tile,zoom){var z=zoom-(this.projection_?this.projection_.minZoom:this.minZoom);var url="";if(!isNaN(tile.x)&&!isNaN(tile.y)&&z>=0&&tile.x>=0&&tile.y>=0){var u=this.mapService_.url;if(this.urlTemplate_){u=this.urlTemplate_.replace("["+this.numOfHosts_+"]",""+((tile.y+tile.x)%this.numOfHosts_))}var prj=this.projection_||(this.map_?this.map_.getProjection():Projection.WEB_MECATOR);if(!prj instanceof Projection){prj=Projection.WEB_MECATOR}var size=prj.tileSize_;var numOfTiles=1<<zoom;var gworldsw=new G.Point(tile.x*size.width/numOfTiles,(tile.y+1)*size.height/numOfTiles);var gworldne=new G.Point((tile.x+1)*size.width/numOfTiles,tile.y*size.height/numOfTiles);var bnds=new G.LatLngBounds(prj.fromPointToLatLng(gworldsw),prj.fromPointToLatLng(gworldne));var fullBounds=this.mapService_.getFullBounds();if(this.mapService_.singleFusedMapCache===false||zoom>this.dynaZoom){var params={f:"image"};params.bounds=bnds;params.format="png32";params.width=size.width;params.height=size.height;params.imageSR=prj.spatialReference_;url=this.mapService_.exportMap(params)}else{if(fullBounds&&!fullBounds.intersects(bnds)){url=""}else{url=u+"/tile/"+z+"/"+tile.y+"/"+tile.x}}}return url};TileLayer.prototype.setOpacity=function(op){this.opacity_=op;var tiles=this.tiles_;for(var x in tiles){if(tiles.hasOwnProperty(x)){setNodeOpacity_(tiles[x],op)}}};TileLayer.prototype.getOpacity=function(){return this.opacity_};TileLayer.prototype.getMapService=function(){return this.mapService_};function MapType(tileLayers,opt_typeOpts){opt_typeOpts=opt_typeOpts||{};var i;if(opt_typeOpts.opacity){this.opacity_=opt_typeOpts.opacity;delete opt_typeOpts.opacity}augmentObject_(opt_typeOpts,this);var layers=tileLayers;if(isString_(tileLayers)){layers=[new TileLayer(tileLayers,opt_typeOpts)]}else{if(tileLayers instanceof MapService){layers=[new TileLayer(tileLayers,opt_typeOpts)]}else{if(tileLayers instanceof TileLayer){layers=[tileLayers]}else{if(tileLayers.length>0&&isString_(tileLayers[0])){layers=[];for(i=0;i<tileLayers.length;i++){layers[i]=new TileLayer(tileLayers[i],opt_typeOpts)}}}}}this.tileLayers_=layers;this.tiles_={};if(opt_typeOpts.maxZoom!==undefined){this.maxZoom=opt_typeOpts.maxZoom}else{var maxZ=0;for(i=0;i<layers.length;i++){maxZ=Math.max(maxZ,layers[i].maxZoom)}this.maxZoom=maxZ}if(layers[0].projection_){this.tileSize=layers[0].projection_.tileSize_;this.projection=layers[0].projection_}else{this.tileSize=new G.Size(256,256)}if(!this.name){this.name=layers[0].name}}MapType.prototype.getTile=function(tileCoord,zoom,ownerDocument){var div=ownerDocument.createElement("div");var tileId="_"+tileCoord.x+"_"+tileCoord.y+"_"+zoom;for(var i=0;i<this.tileLayers_.length;i++){var t=this.tileLayers_[i];if(zoom<=t.maxZoom&&zoom>=t.minZoom){var url=t.getTileUrl(tileCoord,zoom);if(url){var img=ownerDocument.createElement(document.all?"img":"div");img.style.border="0px none";img.style.margin="0px";img.style.padding="0px";img.style.overflow="hidden";img.style.position="absolute";img.style.top="0px";img.style.left="0px";img.style.width=""+this.tileSize.width+"px";img.style.height=""+this.tileSize.height+"px";if(document.all){img.src=url}else{img.style.backgroundImage="url("+url+")"}div.appendChild(img);t.tiles_[tileId]=img;if(t.opacity_!==undefined){setNodeOpacity_(img,t.opacity_)}else{if(this.opacity_!==undefined){setNodeOpacity_(img,this.opacity_)}}}else{}}}this.tiles_[tileId]=div;div.setAttribute("tid",tileId);return div};MapType.prototype.getTile=MapType.prototype.getTile;MapType.prototype.releaseTile=function(node){if(node.getAttribute("tid")){var tileId=node.getAttribute("tid");if(this.tiles_[tileId]){delete this.tiles_[tileId]}for(var i=0;i<this.tileLayers_.length;i++){var t=this.tileLayers_[i];if(t.tiles_[tileId]){delete t.tiles_[tileId]}}}};MapType.prototype.releaseTile=MapType.prototype.releaseTile;MapType.prototype.setOpacity=function(op){this.opacity_=op;var tiles=this.tiles_;for(var x in tiles){if(tiles.hasOwnProperty(x)){var nodes=tiles[x].childNodes;for(var i=0;i<nodes.length;i++){setNodeOpacity_(nodes[i],op)}}}};MapType.prototype.getOpacity=function(){return this.opacity_};MapType.prototype.getTileLayers=function(){return this.tileLayers_};function MapOverlay(service,opt_overlayOpts){opt_overlayOpts=opt_overlayOpts||{};this.mapService_=(service instanceof MapService)?service:new MapService(service);this.minZoom=opt_overlayOpts.minZoom;this.maxZoom=opt_overlayOpts.maxZoom;this.opacity_=opt_overlayOpts.opacity||1;this.exportOptions_=opt_overlayOpts.exportOptions||{};this.drawing_=false;this.needsNewRefresh_=false;this.overlay_=null;this.div_=null;if(opt_overlayOpts.map){this.setMap(opt_overlayOpts.map)}this.map_=null;this.listeners_=[]}MapOverlay.prototype=new G.OverlayView();MapOverlay.prototype.onAdd=function(){var me=this;this.listeners_.push(G.event.addListener(this.getMap(),"bounds_changed",callback_(this.refresh,this)));this.listeners_.push(G.event.addListener(this.getMap(),"dragstart",function(){me.dragging=true}));this.listeners_.push(G.event.addListener(this.getMap(),"dragend",function(){me.dragging=false}));var map=this.getMap();map.agsOverlays=map.agsOverlays||new G.MVCArray();map.agsOverlays.push(this);setCopyrightInfo_(map);this.map_=map};MapOverlay.prototype.onAdd=MapOverlay.prototype.onAdd;MapOverlay.prototype.onRemove=function(){for(var i=0,j=this.listeners_.length;i<j;i++){G.event.removeListener(this.listeners_[i])}if(this.overlay_){this.overlay_.setMap(null)}var map=this.map_;var agsOvs=map.agsOverlays;if(agsOvs){for(var i=0,c=agsOvs.getLength();i<c;i++){if(agsOvs.getAt(i)==this){agsOvs.removeAt(i);break}}}setCopyrightInfo_(map);this.map_=null};MapOverlay.prototype.onRemove=MapOverlay.prototype.onRemove;MapOverlay.prototype.draw=function(){if(!this.drawing_||this.needsNewRefresh_===true){this.refresh()}};MapOverlay.prototype.draw=MapOverlay.prototype.draw;MapOverlay.prototype.getOpacity=function(){return this.opacity_};MapOverlay.prototype.setOpacity=function(opacity){var op=Math.min(Math.max(opacity,0),1);this.opacity_=op;if(this.overlay_){setNodeOpacity_(this.overlay_.div_,op)}};MapOverlay.prototype.getMapService=function(){return this.mapService_};MapOverlay.prototype.refresh=function(){if(this.drawing_===true){this.needsNewRefresh_=true;return}var m=this.getMap();var bnds=m?m.getBounds():null;if(!bnds){return}var params=this.exportOptions_;params.bounds=bnds;var sr=WEB_MERCATOR;var s=m.getDiv();params.width=s.offsetWidth;params.height=s.offsetHeight;if(s.offsetWidth==0||s.offsetHeight==0){return}var prj=m.getProjection();if(prj&&prj instanceof Projection){sr=prj.spatialReference_}params.imageSR=sr;triggerEvent_(this,"drawstart");var me=this;this.drawing_=true;if(!this.dragging&&this.overlay_){this.overlay_.setMap(null);this.overlay_=null}this.mapService_.exportMap(params,function(json){me.drawing_=false;if(me.needsNewRefresh_===true){me.needsNewRefresh_=false;me.refresh();return}if(json.href){if(me.overlay_){me.overlay_.setMap(null);me.overlay_=null}me.overlay_=new ImageOverlay(json.bounds,json.href,me.map_,me.opacity_)}triggerEvent_(me,"drawend")})};MapOverlay.prototype.isHidden=function(){return !(this.visible_&&this.isInZoomRange_())};MapOverlay.prototype.isInZoomRange_=function(){var z=this.getMap().getZoom();if((this.minZoom!==undefined&&z<this.minZoom)||(this.maxZoom!==undefined&&z>this.maxZoom)){return false}return true};MapOverlay.prototype.show=function(){this.visible_=true;this.div_.style.visibility="visible";this.refresh()};MapOverlay.prototype.hide=function(){this.visible_=false;this.div_.style.visibility="hidden"};function ImageOverlay(bounds,url,map,op){this.bounds_=bounds;this.url_=url;this.map_=map;this.div_=null;this.op_=op;this.setMap(map)}ImageOverlay.prototype=new G.OverlayView();ImageOverlay.prototype.onAdd=function(){var div=document.createElement("DIV");div.style.border="none";div.style.borderWidth="0px";div.style.position="absolute";div.style.backgroundImage="url("+this.url_+")";this.div_=div;var panes=this.getPanes();setNodeOpacity_(div,this.op_);panes.overlayLayer.appendChild(div)};ImageOverlay.prototype.draw=function(){var overlayProjection=this.getProjection();var sw=overlayProjection.fromLatLngToDivPixel(this.bounds_.getSouthWest());var ne=overlayProjection.fromLatLngToDivPixel(this.bounds_.getNorthEast());var div=this.div_;div.style.left=sw.x+"px";div.style.top=ne.y+"px";div.style.width=(ne.x-sw.x)+"px";div.style.height=(sw.y-ne.y)+"px"};ImageOverlay.prototype.onRemove=function(){this.div_.parentNode.removeChild(this.div_);this.div_=null};function CopyrightControl(map){this.map_=map;setCopyrightInfo_(map)}CopyrightControl.prototype.refresh=function(){setCopyrightInfo_(this.map_)};gmaps.ags={SpatialReference:SpatialReference,Geographic:Geographic,LambertConformalConic:LambertConformalConic,SphereMercator:SphereMercator,TransverseMercator:TransverseMercator,SpatialRelationship:SpatialRelationship,GeometryType:GeometryType,SRUnit:SRUnit,Catalog:Catalog,MapService:MapService,Layer:Layer,GeocodeService:GeocodeService,GeometryService:GeometryService,GPService:GPService,GPTask:GPTask,RouteTask:RouteTask,Util:Util,Config:Config,Projection:Projection,TileLayer:TileLayer,MapOverlay:MapOverlay,MapType:MapType,CopyrightControl:CopyrightControl};window.gmaps=gmaps})();

globalConfig={};globalConfig.language="EN";globalConfig.otherInfoHTML="";globalConfig.url="http://www.appliomaps.lrc.gov.on.ca/ArcGIS/rest/services/MOE/PTTW_Search/MapServer";globalConfig.InformationLang="Information";globalConfig.chooseLang=function(b,a){return(globalConfig.language==="EN")?b:a};globalConfig.searchableFieldsList=[{en:"watershed",fr:"bassin versant"},{en:"permit holder name",fr:"nom du titulaire de permis"},{en:"address",fr:"adresse"}];globalConfig.searchHelpTxt=globalConfig.chooseLang("You may search by ","Vous pouvez rechercher par ");for(var i=0;i<globalConfig.searchableFieldsList.length-1;i++){globalConfig.searchHelpTxt=globalConfig.searchHelpTxt+"<strong>"+globalConfig.chooseLang(globalConfig.searchableFieldsList[i].en,globalConfig.searchableFieldsList[i].fr)+"</strong>, "}globalConfig.searchHelpTxt=globalConfig.searchHelpTxt+"<strong>"+globalConfig.chooseLang(globalConfig.searchableFieldsList[i].en,globalConfig.searchableFieldsList[i].fr)+"</strong> "+globalConfig.chooseLang("or see help for advanced options.","ou consulter l'aide pour de l'information sur les recherches avanc&eacute;es.");globalConfig.tableSimpleTemplateTitleLang=globalConfig.chooseLang("Note: Data is in English only.","\u00c0 noter : les donn\u00e9es sont en anglais seulement.");globalConfig.searchControlHTML='<div id="searchTheMap"></div><div id="searchHelp"></div><br><label class="element-invisible" for="map_query">'+globalConfig.chooseLang("Search the map","Recherche carte interactive")+'</label>	<input id="map_query" type="text" title="'+globalConfig.chooseLang("Search term","Terme de recherche")+'" maxlength="100" size="50" onkeypress="return globalConfig.entsub(event)"></input>	<label class="element-invisible" for="search_submit">'+globalConfig.chooseLang("Search","Recherche")+'</label>	<input id="search_submit" type="submit" title="'+globalConfig.chooseLang("Search","Recherche")+'" onclick="globalConfig.search()" value="'+globalConfig.chooseLang("Search","Recherche")+'"></input>	<fieldset>		<input type="radio" id="searchWatershed" name="searchGroup" title="'+globalConfig.chooseLang("Watershed","Bassin versant")+'" name="watershed" value="watershed" onclick="globalConfig.searchChange(\'Watershed\')"></input>		<label class="option" for="watershed">			'+globalConfig.chooseLang("Watershed","Bassin versant")+'		</label>		<input type="radio" id="searchBusiness" name="searchGroup" title="'+globalConfig.chooseLang("Permit Holder Name","Nom du titulaire de permis")+'" name="business" value="business" onclick="globalConfig.searchChange(\'Business\')"></input>		<label class="option" for="business">			'+globalConfig.chooseLang("Permit Holder Name","Nom du titulaire de permis")+'		</label>		<input type="radio" id="searchLocation" name="searchGroup" title="'+globalConfig.chooseLang("Address with Radius of","Adresse dans un rayon de")+'" name="location" value="location" onclick="globalConfig.searchChange(\'Location\')"></input>		<label class="option" for="location">			'+globalConfig.chooseLang("Address with Radius of","Adresse dans un rayon de")+'			<select name="searchCriteria.radius" id="lstRadius">				<option value="1" >1 km</option>				<option value="2" >2 km</option>				<option value="5" >5 km</option>				<option value="10" >10 km</option>				<option value="25" >25 km</option>				<option value="50" >50 km</option>			</select>		</label>	</fieldset><div id="information"></div>';if(globalConfig.accessible){globalConfig.usePredefinedMultipleTabs=false}else{globalConfig.usePredefinedMultipleTabs=true}globalConfig.infoWindowWidth="560px";globalConfig.infoWindowHeight="200px";globalConfig.infoWindowContentHeight="160px";globalConfig.isRoutingServiceAvailable=false;globalConfig.displayDisclaimer=true;if(globalConfig.language==="EN"){globalConfig.fieldNamesList=["Permit Number","Permit Holder Name","Purpose","Specific Purpose","Max Litres per Day","Source Type"]}else{globalConfig.fieldNamesList=["Num\u00e9ro du permis","Nom du titulaire de permis","Raison","Raison particuli\u00e8re","Litres (max. par jour)","Type de source"]}if(globalConfig.accessible){globalConfig.queryLayerList=[{url:globalConfig.url+"/0",tableTemplate:{title:globalConfig.tableSimpleTemplateTitleLang,content:"<tr><td>{PERMITNO}</td><td>{CLIENTNAME}</td><td>{PURPOSECAT}</td><td>{SPURPOSE}</td><td>{MAXL_DAY}</td><td>{SURFGRND}</td></tr>",head:"<table class='fishTable'  border='1'><tr><th class='shaded'><center>"+globalConfig.fieldNamesList.join("</center></th><th class='shaded'><center>")+"</center></th></tr>",tail:"</table>"}}];globalConfig.postConditionsCallbackName="AccessibleWells"}else{globalConfig.tableFieldList=[{name:globalConfig.fieldNamesList[0],value:"{PERMITNO}"},{name:globalConfig.fieldNamesList[1],value:"{CLIENTNAME}"},{name:globalConfig.fieldNamesList[2],value:"{PURPOSECAT}"},{name:globalConfig.fieldNamesList[3],value:"{SPURPOSE}"},{name:globalConfig.fieldNamesList[4],value:"{MAXL_DAY}"},{name:globalConfig.fieldNamesList[5],value:"{SURFGRND}"}];globalConfig.queryLayerList=[{url:globalConfig.url+"/0",tabsTableTemplate:[{label:globalConfig.InformationLang,content:globalConfig.tableFieldList}],tableSimpleTemplate:{title:globalConfig.tableSimpleTemplateTitleLang,content:globalConfig.tableFieldList}}]}globalConfig.watershedNames=["Agawa","Albany - Mouth","Arrow","Atikameg","Ausable","Big Creek","Black Duck","Black River - Lake Simcoe","Black Sturgeon","Bonnechere","Cataraqui","Cedar Creek","Central Abitibi","Central Mattagami","Central Missinaibi - Mattawishkwia","Central Missinaibi - Mattawitchewan","Central Rainy","Central Severn","Credit River - 16 Mile Creek","Crowe","Deep","Dog","Dogskin","Drowning","Echoing","Englehart","Fawn","French","Ganaraska","Garden","Goulais","Gull","Humber - Don Rivers","Jackpine","Kabinakagami","Kaskattama","Kattawagami","Kawartha Lakes","Kesagami","Killarney Channel","Kinosheo","Lac Seul","Lake of the Woods","Larus","Little Current","Little Pic","Lower Attawapiskat","Lower Ekwan","Lower English","Lower Grand","Lower Groundhog","Lower Kapuskasing","Lower Kenogami","Lower Madawaska","Lower Mattagami","Lower Missinaibi","Lower Ogoki","Lower Ottawa - South Nation","Lower Rainy","Lower Thames","Lower Winisk","Lower Winnipeg","Magnetawan","Maitland","Manatoulin Islands","Manigotagan","Mattagami","Michipicoten - Magpie","Middle Attawapiskat","Middle Winisk","Mississagi","Mississippi","Moira","Montreal","Muskoka","Napanee","Negagami","Niagara","Nipigon","Niskibi","North Grey Sauble Bruce Peninsula Watersheds","North Wanapitei","Nottawasaga","Oiseau","Onaping","Opasatika","Otonabee","Otter Rapids - Abitiby River Watersheds","Owen Sound Watersheds","Penetangore","Petawawa","Pic","Polar Bear Park Watersheds","Poplar","Prince Edward Bay","Red","Rideau","Ridge","Rondeau Watersheds","Sachigo","Sagawitchewan","Saugeen","Scugog","Seeber","Serpent","Shagamu","South Wanapitei","Spanish","Sturgeon","Sutton","Sydenham","Upper Abitibi","Upper Albany - Cat","Upper Albany - Makokibatan","Upper Albany - Misehkow","Upper Albany - Muswabik","Upper Attawapiskat","Upper Berens","Upper Ekwan","Upper English","Upper Grand","Upper Groundhog","Upper Kapiskau","Upper Kapuskasing","Upper Kenogami","Upper Madawaska","Upper Missinaibi","Upper Moose","Upper Ogoki","Upper Ottawa - Kipawa","Upper Rainy","Upper Severn","Upper St. Lawrence - Raisin","Upper St. Lawrence - Thousand Islands","Upper Thames","Upper Winisk","Upper Winnipeg","Wabigoon","Watabeag","Wenebegon","White","Whitefish","Whiteshell","Windigo"];globalConfig.watershedTypeParameter="Watershed";globalConfig.searchChange=function(a){document.getElementById(globalConfig.searchInputBoxDivId).value="";if(a===globalConfig.businessTypeParameter){$("#"+globalConfig.searchInputBoxDivId).autocomplete({disabled:true,source:[]});document.getElementById(globalConfig.radiusSelectionDivId).disabled=true}else{if(a===globalConfig.watershedTypeParameter){document.getElementById(globalConfig.radiusSelectionDivId).disabled=true;$("#"+globalConfig.searchInputBoxDivId).autocomplete({source:globalConfig.watershedNames,disabled:false,select:function(f,d){MOEMAP.clearOverlays();var b=d.item.value;var c={searchString:b,withinExtent:false,where:"NAME = '"+b+"'",requireGeocode:false,address:b};MOEMAP.queryLayersWithConditionsExtent(c)}})}else{$("#"+globalConfig.searchInputBoxDivId).autocomplete({disabled:true,source:[]});document.getElementById(globalConfig.radiusSelectionDivId).disabled=false}}};globalConfig.searchWatershedDivId="searchWatershed";globalConfig.search=function(){var b=document.getElementById(globalConfig.searchInputBoxDivId).value.trim();if(b.length===0){return}document.getElementById(globalConfig.queryTableDivId).innerHTML="";MOEMAP.clearOverlays();var d={searchString:b,withinExtent:false};if(globalConfig.accessible||document.getElementById(globalConfig.searchBusinessDivId).checked){var a=b.toUpperCase();a=globalConfig.replaceChar(a,"'","''");a=globalConfig.replaceChar(a,"\u2019","''");var c=function(e,f){return"(UPPER("+e+") LIKE '% "+f+" %') OR (UPPER("+e+") LIKE '"+f+" %') OR (UPPER("+e+") LIKE '% "+f+"') OR (UPPER("+e+") = '"+f+"') OR (UPPER("+e+") LIKE '%"+f+",%')"};d.where=c("CLIENTNAME",a);d.requireGeocode=false;d.address=b;MOEMAP.queryLayersWithConditionsExtent(d);return}if(document.getElementById(globalConfig.searchWatershedDivId).checked){d.where="NAME = '"+b+"'";d.requireGeocode=false;d.address=b;MOEMAP.queryLayersWithConditionsExtent(d);return}if(document.getElementById(globalConfig.searchLocationDivId).checked){d.address=b;d.radius=document.getElementById(globalConfig.radiusSelectionDivId).value;d.callback=MOEMAP.addressBufferCallback;LOCATOR.locate(d)}};if(!globalConfig.accessible){globalConfig.autoCompleteSearch=function(){$("#"+globalConfig.searchInputBoxDivId).autocomplete({source:[],select:function(b,a){},disabled:true})};$(function(){globalConfig.autoCompleteSearch()})}if(globalConfig.language==="EN"){globalConfig.SearchInteractiveMapFormLang=globalConfig.SearchInteractiveMapFormLang||"Search interactive map form";globalConfig.SearchInteractiveMapLang=globalConfig.SearchInteractiveMapLang||"Search the map";globalConfig.SearchLang=globalConfig.SearchLang||"Search";globalConfig.TermLang=globalConfig.TermLang||"Term";globalConfig.InputBoxSizeLang=globalConfig.InputBoxSizeLang||"415px";globalConfig.degreeSymbolLang=globalConfig.degreeSymbolLang||"&deg;";globalConfig.selectTooltip=globalConfig.selectTooltip||"Select";globalConfig.UTM_ZoneLang=globalConfig.UTM_ZoneLang||"UTM Zone";globalConfig.EastingLang=globalConfig.EastingLang||"Easting";globalConfig.NorthingLang=globalConfig.NorthingLang||"Northing";globalConfig.noResultFoundMsg=globalConfig.noResultFoundMsg||"Your search returned no result. Please refine your search.";globalConfig.searchCenterLang=globalConfig.searchCenterLang||"Search center";globalConfig.searchRadiusLang=globalConfig.searchRadiusLang||"search radius";globalConfig.searchKMLang=globalConfig.searchKMLang||"KM";globalConfig.totalFeatureReturnedLang=globalConfig.totalFeatureReturnedLang||"Total features returned";globalConfig.only1DisplayedLang=globalConfig.only1DisplayedLang||", only 1 is displayed.";globalConfig.westSymbolLang=globalConfig.westSymbolLang||"W";globalConfig.distanceLang=globalConfig.distanceLang||"Distance (KM)";globalConfig.searchingLang=globalConfig.searchingLang||"Searching for results...";globalConfig.inGobalRegionLang=globalConfig.inGobalRegionLang||"in Ontario";globalConfig.inCurrentMapExtentLang=globalConfig.inCurrentMapExtentLang||"in the current map display";globalConfig.forLang="for";globalConfig.yourSearchLang=globalConfig.yourSearchLang||"Your search";globalConfig.returnedNoResultLang=globalConfig.returnedNoResultLang||"returned no result";globalConfig.pleaseRefineSearchLang=globalConfig.pleaseRefineSearchLang||"Please refine your search";globalConfig.oneResultFoundLang=globalConfig.oneResultFoundLang||"1 result found";globalConfig.moreThanLang=globalConfig.moreThanLang||"More than";globalConfig.resultsFoundLang=globalConfig.resultsFoundLang||"results found";globalConfig.onlyLang=globalConfig.onlyLang||"Only";globalConfig.returnedLang=globalConfig.returnedLang||"returned";globalConfig.seeHelpLang=globalConfig.seeHelpLang||"See help for options to refine your search";globalConfig.disclaimerLang=globalConfig.disclaimerLang||'<p>This website and all of the information it contains are provided &quot;as is&quot; without warranty of any kind, whether express or implied. <a href="/environment/en/resources/collection/data_downloads/STDPROD_078135.html">View the terms of use</a>.</p>';globalConfig.InformationLang=globalConfig.InformationLang||"Information";globalConfig.CurrentMapDisplayLang=globalConfig.CurrentMapDisplayLang||"Search current map display only";globalConfig.CurrentMapDisplayTitleLang=globalConfig.CurrentMapDisplayTitleLang||"Current Map Display: Limit your search to the area displayed";globalConfig.distanceFieldNote=globalConfig.distanceFieldNote||"The Distance(KM) column represents the distance between your search location and the permit location in the specific row.";globalConfig.noCoordinatesTableTitleLang=globalConfig.noCoordinatesTableTitleLang||"The following table contains the records without valid coordinates. <a href='#WhyAmISeeingThis'>Why am I seeing this?</a>";globalConfig.whyAmISeeingThisLang=globalConfig.whyAmISeeingThisLang||"<a id='WhyAmISeeingThis'><strong>Why am I seeing this?</strong></a><br>The map locations shown as points have been determined by using addresses or other information to calculate a physical location on the map.  In some cases, the information needed to calculate a location was incomplete, incorrect or missing.  The records provided in the table have been included because there is a close match on the name or city/town or other field(s). These records may or may not be near your specified location, and users are cautioned in using these records. They have been included as potential matches only.";globalConfig.ThisResultDoesNotHaveValidCoordinates=globalConfig.ThisResultDoesNotHaveValidCoordinates||"This result does not have valid coordinates.";globalConfig.AmongReturnedResults=globalConfig.AmongReturnedResults||"Among returned results";globalConfig.ResultDoesNotHaveValidCoordinates=globalConfig.ResultDoesNotHaveValidCoordinates||" result does not have valid coordinates.";globalConfig.ResultsDoNotHaveValidCoordinates=globalConfig.ResultsDoNotHaveValidCoordinates||" results do not have valid coordinates.";globalConfig.youMaySearchByLang=globalConfig.youMaySearchByLang||"You may search by ";globalConfig.seeHelpForAdvancedOptionsLang=globalConfig.seeHelpForAdvancedOptionsLang||"or see help for advanced options."}else{globalConfig.SearchInteractiveMapFormLang=globalConfig.SearchInteractiveMapFormLang||"Recherche carte interactive forme";globalConfig.SearchInteractiveMapLang=globalConfig.SearchInteractiveMapLang||"Recherche dans la carte interactive";globalConfig.SearchLang=globalConfig.SearchLang||"Recherche";globalConfig.TermLang=globalConfig.TermLang||"Terme";globalConfig.InputBoxSizeLang=globalConfig.InputBoxSizeLang||"450px";globalConfig.degreeSymbolLang=globalConfig.degreeSymbolLang||"&deg;";globalConfig.selectTooltip=globalConfig.selectTooltip||globalConfig.selectTooltip||"Choisir";globalConfig.UTM_ZoneLang=globalConfig.UTM_ZoneLang||"Zone UTM";globalConfig.EastingLang=globalConfig.EastingLang||"abscisse";globalConfig.NorthingLang=globalConfig.NorthingLang||"ordonn\u00e9e";globalConfig.noResultFoundMsg=globalConfig.noResultFoundMsg||"Votre recherche n'a produit aucun r\u00e9sultat. Veuillez affiner la recherche.";globalConfig.searchCenterLang=globalConfig.searchCenterLang||"Cercle de recherche";globalConfig.searchRadiusLang=globalConfig.searchRadiusLang||"rayon de recherche";globalConfig.searchKMLang=globalConfig.searchKMLang||"km";globalConfig.totalFeatureReturnedLang=globalConfig.totalFeatureReturnedLang||"Nombre total de r\u00e9sultats";globalConfig.only1DisplayedLang=globalConfig.only1DisplayedLang||", only 1 is displayed.";globalConfig.westSymbolLang=globalConfig.westSymbolLang||"O";globalConfig.distanceLang=globalConfig.distanceLang||"Distance (en km)";globalConfig.searchingLang=globalConfig.searchingLang||"Recherche des r\u00e9sultats ...";globalConfig.inGobalRegionLang=globalConfig.inGobalRegionLang||"en Ontario";globalConfig.inCurrentMapExtentLang=globalConfig.inCurrentMapExtentLang||"dans l'affichage actuel de la carte";globalConfig.forLang="pour";globalConfig.yourSearchLang=globalConfig.yourSearchLang||"Votre recherche";globalConfig.returnedNoResultLang=globalConfig.returnedNoResultLang||"n'a donn\u00e9 aucun r\u00e9sultat";globalConfig.pleaseRefineSearchLang=globalConfig.pleaseRefineSearchLang||"S'il vous plait affiner votre recherche";globalConfig.oneResultFoundLang=globalConfig.oneResultFoundLang||"1 r\u00e9sultat";globalConfig.moreThanLang=globalConfig.moreThanLang||"Plus de";globalConfig.resultsFoundLang=globalConfig.resultsFoundLang||"r\u00e9sultats";globalConfig.onlyLang=globalConfig.onlyLang||"Seulement";globalConfig.returnedLang=globalConfig.returnedLang||"retourn\u00e9s";globalConfig.seeHelpLang=globalConfig.seeHelpLang||"Consulter l'aide pour affiner votre recherche";globalConfig.disclaimerLang=globalConfig.disclaimerLang||'<p>Ce site web et toute l&rsquo;information qu&rsquo;il contient sont fournis sans garantie quelconque, expr&egrave;s ou tacite. <a href="/environment/fr/resources/collection/data_downloads/STDPROD_078138.html">Voir l&rsquo;avis de non-responsabilit&eacute;</a>.</p>';globalConfig.InformationLang=globalConfig.InformationLang||"Information";globalConfig.CurrentMapDisplayLang=globalConfig.CurrentMapDisplayLang||"\u00c9tendue de la carte courante";globalConfig.CurrentMapDisplayTitleLang=globalConfig.CurrentMapDisplayTitleLang||"Afficher la carte : Limiter la recherche \u00e0 la carte donn\u00e9e.";globalConfig.distanceFieldNote=globalConfig.distanceFieldNote||"La colonne de distance (en km) donne la distance entre le lieu de votre recherche et le lieu du puits dans la rang\u00e9e donn\u00e9e.";globalConfig.noCoordinatesTableTitleLang=globalConfig.noCoordinatesTableTitleLang||"Le tableau suivant contient des données sans coordonnées valides.  <a href='#WhyAmISeeingThis'>Pourquoi cela s’affiche-t-il?</a>";globalConfig.whyAmISeeingThisLang=globalConfig.whyAmISeeingThisLang||"<a id='WhyAmISeeingThis'>Pourquoi cela s’affiche-t-il?</a><br>Les lieux indiqués par des points sur la carte ont été déterminés en fonction d’adresses ou d’autres renseignements servant à calculer un emplacement physique sur la carte. Dans certains cas, ces renseignements étaient incomplets, incorrects ou manquants. Les données fournies dans le deuxième tableau ont été incluses, car il y a une correspondance étroite avec le nom de la ville ou d’autre champ. Ces données peuvent ou non être proches du lieu précisé, et on doit les utiliser avec prudence. Elles ont été incluses seulement parce qu’il peut y avoir une correspondance.";globalConfig.ThisResultDoesNotHaveValidCoordinates=globalConfig.ThisResultDoesNotHaveValidCoordinates||"This result does not have valid coordinates.";globalConfig.AmongReturnedResults=globalConfig.AmongReturnedResults||"Parmi les résultats obtenus";globalConfig.ResultDoesNotHaveValidCoordinates=globalConfig.ResultDoesNotHaveValidCoordinates||" résultat n’a pas de coordonnées valides.";globalConfig.ResultsDoNotHaveValidCoordinates=globalConfig.ResultsDoNotHaveValidCoordinates||" résultats n’ont pas de coordonnées valides.";globalConfig.youMaySearchByLang=globalConfig.youMaySearchByLang||"Vous pouvez rechercher par ";globalConfig.seeHelpForAdvancedOptionsLang=globalConfig.seeHelpForAdvancedOptionsLang||"ou consulter l'aide pour de l'information sur les recherches avanc&eacute;es.";globalConfig.dataTableLang=globalConfig.dataTableLang||{sProcessing:"Traitement en cours...",sSearch:"Rechercher&nbsp;:",sLengthMenu:"Afficher _MENU_ &eacute;l&eacute;ments",sInfo:"Affichage de l'&eacute;lement _START_ &agrave; _END_ sur _TOTAL_ &eacute;l&eacute;ments",sInfoEmpty:"Affichage de l'&eacute;lement 0 &agrave; 0 sur 0 &eacute;l&eacute;ments",sInfoFiltered:"(filtr&eacute; de _MAX_ &eacute;l&eacute;ments au total)",sInfoPostFix:"",sLoadingRecords:"Chargement en cours...",sZeroRecords:"Aucun &eacute;l&eacute;ment &agrave; afficher",sEmptyTable:"Aucune donn&eacute;e disponible dans le tableau",oPaginate:{sFirst:"Premier",sPrevious:"Pr&eacute;c&eacute;dent",sNext:"Suivant",sLast:"Dernier"},oAria:{sSortAscending:": activer pour trier la colonne par ordre croissant",sSortDescending:": activer pour trier la colonne par ordre d&eacute;croissant"}}}globalConfig.u2019Lang="\u2019";globalConfig.nbspLang="&nbsp";var globalConfig=globalConfig||{};if(typeof console=="undefined"){window.console={log:function(){}}}if(!("trim" in String.prototype)){String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}}if(!Array.prototype.indexOf){Array.prototype.indexOf=function(c,d){var b;if(this==null){throw new TypeError('"this" is null or not defined')}var f=Object(this);var a=f.length>>>0;if(a===0){return -1}var g=+d||0;if(Math.abs(g)===Infinity){g=0}if(g>=a){return -1}b=Math.max(g>=0?g:a-Math.abs(g),0);while(b<a){var e;if(b in f&&f[b]===c){return b}b++}return -1}}if(!("contains" in Array.prototype)){Array.prototype.contains=function(a){return(this.indexOf(a)>=0)}}if(!("unique" in Array.prototype)){Array.prototype.unique=function(){var b=[];for(var a=0;a<this.length;a++){if(b.indexOf(this[a])<0){b.push(this[a])}}return b}}if(!Array.prototype.filter){Array.prototype.filter=function(b){if(this==null){throw new TypeError()}var f=Object(this);var a=f.length>>>0;if(typeof b!="function"){throw new TypeError()}var e=[];var d=arguments[1];for(var c=0;c<a;c++){if(c in f){var g=f[c];if(b.call(d,g,c,f)){e.push(g)}}}return e}}if(!Array.prototype.map){Array.prototype.map=function(j,h){var b,a,c;if(this===null){throw new TypeError(" this is null or not defined")}var e=Object(this);var f=e.length>>>0;if(typeof j!=="function"){throw new TypeError(j+" is not a function")}if(h){b=h}a=new Array(f);c=0;while(c<f){var d,g;if(c in e){d=e[c];g=j.call(b,d,c,e);a[c]=g}c++}return a}}if("function"!==typeof Array.prototype.reduce){Array.prototype.reduce=function(f,d){if(null===this||"undefined"===typeof this){throw new TypeError("Array.prototype.reduce called on null or undefined")}if("function"!==typeof f){throw new TypeError(f+" is not a function")}var a=0,b=this.length>>>0,c,e=false;if(1<arguments.length){c=d;e=true}for(;b>a;++a){if(!this.hasOwnProperty(a)){continue}if(e){c=f(c,this[a],a,this)}else{c=this[a];e=true}}if(!e){throw new TypeError("Reduce of empty array with no initial value")}return c}}Array.range=function(e,d,g){var c=[];if(typeof e=="number"){c[0]=e;g=g||1;while(e+g<=d){c[c.length]=e+=g}}else{var f="abcdefghijklmnopqrstuvwxyz";if(e===e.toUpperCase()){d=d.toUpperCase();f=f.toUpperCase()}f=f.substring(f.indexOf(e),f.indexOf(d)+1);c=f.split("")}return c};if(typeof Number.prototype.toRad=="undefined"){Number.prototype.toRad=function(){return this*Math.PI/180}}globalConfig.replaceChar=globalConfig.replaceChar||function(f,c,b){var d=[];d=f.split(c);var a=d[0];if(d.length>=2){for(var e=1;e<d.length;e++){a=a+b+d[e]}}return a};globalConfig.wordCapitalize=globalConfig.wordCapitalize||function(c){var a=c.trim().split(" ");for(var b=0;b<a.length;b++){a[b]=a[b].substring(0,1).toUpperCase()+a[b].substring(1,a[b].length).toLowerCase()}return a.join(" ")};globalConfig.convertLatLngtoUTM=globalConfig.convertLatLngtoUTM||function(j,M){var E=3.14159265358979;var G=6378137;var q=0.9996;var C=0.081819191;var d=0.006694380015894481;var b=6367449.146;var v=16038.42955;var B=16.83261333;var c=0.021984404;var z=0.000312705;var D=31+Math.floor(M/6);var f=j*E/180;var w=Math.sin(f);var t=C*w*C*w;var r=Math.cos(f);var p=Math.tan(f);var I=G/(Math.sqrt(1-t));var g=b*f-v*Math.sin(2*f)+B*Math.sin(4*f)-c*Math.sin(6*f)+z*Math.sin(8*f);var o=g*q;var n=I*w*r*q/2;var m=((I*w*t*t*t)/24)*(5-p*p+9*d*r*r+4*d*d*r*r*r*r)*q;var k=I*r*q;var h=r*r*r*(I/6)*(1-p*p+d*r*r)*q;var l=6*D-183;var L=(M-l)*E/180;var J=L*L;var H=J*L;var F=H*L;var u=500000+(k*L+h*H);var A=(o+n*J+m*F);var s=A;if(s<0){s=s+10000000}var K={Zone:D,Easting:u.toFixed(0),Northing:s.toFixed(0)};return K};globalConfig.convertUTMtoLatLng=globalConfig.convertUTMtoLatLng||function(r,t,w){var u=3.14159265358979;var Z=6378137;var B=0.9996;var X=0.081819191;var T=0.006694380015894481;var k=500000-w;var v=t/B;var S=T*T;var R=S*T;var N=Math.sqrt(1-T);var y=(1-N)/(1+N);var q=y*y;var o=q*y;var n=o*y;var J=3*y/2-27*o/32;var G=21*q/16-55*n/32;var F=151*o/96;var C=1097*n/512;var l=v/(Z*(1-T/4-3*S/64-5*R/256));var Q=l+J*Math.sin(2*l)+G*Math.sin(4*l)+F*Math.sin(6*l)+C*Math.sin(8*l);var V=Math.cos(Q);var x=Math.tan(Q);var j=x*x;var b=Math.sin(Q);var W=X*b;var K=1-W*W;var H=Math.sqrt(K);var c=Z/H;var P=Z*(1-T)/(K*H);var s=k/(c*B);var E=s*s;var A=E*E;var z=A*E;var h=c*x/P;var g=E/2;var f=(5+3*j+10*J-4*J*J-9*T)*A/24;var d=(61+90*j+298*J+45*j*j-252*T-3*J*J)*z/720;var O=s;var M=(1+2*j+J)*E*s/6;var I=(5-2*J+28*j-3*J*J+8*T+24*j*j)*A*s/120;var Y=(O-M+I)/V;var p=6*r-183;var m=180*(Q-h*(g+f+d))/u;var U=p-Y*180/u;var L={Latitude:m.toFixed(8),Longitude:U.toFixed(8)};return L};globalConfig.isInsidePolygon=globalConfig.isInsidePolygon||function(c,a){var f=c.lat();var h=c.lng();var g=a.length;var b=false;var d=g-1;for(var e=0;e<g;e++){var l={x:a[e].lng(),y:a[e].lat()};var k={x:a[d].lng(),y:a[d].lat()};if(l.x<h&&k.x>=h||k.x<h&&l.x>=h){if(l.y+(h-l.x)/(k.x-l.x)*(k.y-l.y)<f){b=!b}}d=e}return b};globalConfig.deciToDegree=globalConfig.deciToDegree||function(f){if(Math.abs(f)<=0.1){return"N/A"}var b="N";if(f<0){f=-f;b=globalConfig.westSymbolLang}var e=Math.floor(f);var a=(f-e)*60;var g=Math.floor(a);var c=((a-g)*60).toFixed(0);var d="";if(c<1){d=""+e+globalConfig.degreeSymbolLang+g+"'"}else{if(c>58){d=""+e+globalConfig.degreeSymbolLang+(g+1)+"'"}else{d=""+e+globalConfig.degreeSymbolLang+g+"'"+c+'"'}}return d+b};globalConfig.addBRtoLongText=function(f){var b=0;var e=false;if(f.length<=40){return f}var c=f.split("");var a="";for(var d=0;d<c.length;d++){if(b>40){e=true}a=a+c[d];if((e)&&(c[d]===" ")){b=0;a=a+"<br>";e=false}b=b+1}return a};globalConfig.processNA=function(a){if(typeof(a)==="undefined"){return"N/A"}if(a==="null"){return"N/A"}if(a==="Null"){return"N/A"}return a};var globalConfig=globalConfig||{};globalConfig.failedLocation=globalConfig.failedLocation||{positions:[[51.253775,-85.32321389999998],[42.832714,-80.279923]],difference:0.00001};globalConfig.regionBoundary=globalConfig.regionBoundary||[{x:-95.2992035,y:48.77505703},{x:-95.2992035,y:53.07150598},{x:-89.02502409,y:56.9587693},{x:-87.42238044,y:56.34499088},{x:-86.3653176,y:55.93580527},{x:-84.69447635,y:55.45842206},{x:-81.89837466,y:55.35612565},{x:-81.96657226,y:53.17380238},{x:-80.84131182,y:52.28723355},{x:-79.98884179,y:51.80985033},{x:-79.34096457,y:51.74165273},{x:-79.34096457,y:47.54750019},{x:-78.55669214,y:46.49043736},{x:-76.61306048,y:46.14944935},{x:-75.59009645,y:45.77436253},{x:-74.123848,y:45.91075774},{x:-73.98745279,y:45.02418891},{x:-75.07861443,y:44.61500329},{x:-75.86288685,y:44.03532368},{x:-76.88585089,y:43.69433566},{x:-79.2,y:43.450196},{x:-78.62488975,y:42.94416204},{x:-79.54555738,y:42.43268002},{x:-81.28459623,y:42.15988961},{x:-82.54625188,y:41.58020999},{x:-83.2623267,y:41.95529681},{x:-83.3646231,y:42.43268002},{x:-82.61444948,y:42.73956923},{x:-82.17116506,y:43.59203926},{x:-82.61444948,y:45.36517692},{x:-84.08069793,y:45.91075774},{x:-84.93316796,y:46.69503016},{x:-88.27485047,y:48.22947621},{x:-89.3319133,y:47.7861918},{x:-90.32077854,y:47.6838954},{x:-92.09391619,y:47.95668581},{x:-94.07164666,y:48.33177262},{x:-95.2992035,y:48.77505703}];globalConfig.TWPSearch=false;globalConfig.TWPLotConSearch=false;globalConfig.UTMRange=globalConfig.UTMRange||{minEasting:258030.3,maxEasting:741969.7,minNorthing:4614583.73,maxNorthing:6302884.09};globalConfig.locatorsAvailable=globalConfig.locatorsAvailable||{latlng:true,utm:true,township:true,address:true};globalConfig.validateLatLngWithRegion=globalConfig.validateLatLngWithRegion||function(d,c){var b=Math.min(d,c);var a=-Math.max(d,c);return{lat:b,lng:a}};globalConfig.isAddressEndsWithRegionName=globalConfig.isAddressEndsWithRegionName||function(a,c){if(a.length>c.length+1){var b=a.substring(a.length-c.length-1);if(b===(" "+c)||b===(","+c)){return true}}return false};globalConfig.regionAddressProcess=globalConfig.regionAddressProcess||function(e){var b=e.toUpperCase();var a=["ON","ONT","ONTARIO"];var d=false;for(var c=0;c<a.length;c++){if(globalConfig.isAddressEndsWithRegionName(b,a[c])){d=true}}if(!d){return e+" Ontario"}return e};globalConfig.defaultZone=globalConfig.defaultZone||17;globalConfig.geogTwpService=globalConfig.geogTwpService||{url:"http://www.appliomaps.lrc.gov.on.ca/ArcGIS/rest/services/MOE/sportfishservice/MapServer",TWPLayerID:0,LotLayerID:1,latitude:"CENY",longitude:"CENX",TWPLayerNameField:"NAME",LotLayerNameFields:{TownshipField:"OFFICIAL_NAME_UPPER",LotField:"LOT_NUM_1",ConField:"CONCESSION_NUMBER"}};LOCATOR=(function(){var h=/^(-?\d+)(\.\d+)?$/;function b(o,r){var q=r;if(r>0){q=-q}var k=globalConfig.regionBoundary;var p=k.length;var l=false;var m=p-1;for(var n=0;n<p;n++){var t=k[n];var s=k[m];if(t.x<q&&s.x>=q||s.x<q&&t.x>=q){if(t.y+(q-t.x)/(s.x-t.x)*(s.y-t.y)<o){l=!l}}m=n}return l}function e(l,k){if(b(l,k)){return{latLng:new google.maps.LatLng(l,k),success:true}}else{return{success:false}}}function g(m,l){var k=globalConfig.UTMRange;return((m<k.maxEasting)&&(m>k.minEasting)&&(l<k.maxNorthing)&&(l>k.minNorthing))}function d(p,m,l){var n=[];n=p.split(m);var k=n[0];if(n.length>=2){for(var o=1;o<n.length;o++){k=k+l+n[o]}}return k}function c(o,u,l){var q=0;var p=0;var w=0;var r=[];for(var v=0;v<o.features.length;v++){var t=o.features[v].attributes;var m=0;for(var k=0;k<o.features[v].geometry.length;k++){var s=o.features[v].geometry[k];m=m+google.maps.geometry.spherical.computeArea(s.getPath());r.push(s)}p=p+(t[u]*m);q=q+(t[l]*m);w=w+m}var n=new google.maps.LatLng(p/w,q/w);return{gLatLng:n,polylines:r}}function f(k,r,n){var q=0;var o=0;for(var m=0;m<k.features.length;m++){var l=k.features[m].attributes;o=o+l[r];q=q+l[n]}var p=new google.maps.LatLng(o/k.features.length,q/k.features.length);return{gLatLng:p}}LATLNG_LOCATOR=(function(){function n(v,u){var t={lat:v,lng:u};t=globalConfig.validateLatLngWithRegion(v,u);return t}function k(u){if(h.test(u[0])&&h.test(u[1])){var w=Math.abs(parseFloat(u[0]));var v=Math.abs(parseFloat(u[1]));var t=n(w,v);return e(t.lat,t.lng)}else{return{success:false}}}function p(x,w){var v={ParsedNum:0,Unparsed:""};if(w.length===0){return v}var u=w.split(x);var t=0;if(u.length<=2){if(h.test(u[0])){t=parseFloat(u[0])}if(u.length===2){w=u[1]}else{w=""}}v={ParsedNum:t,Unparsed:w};return v}function o(u,A,z,y){var B=0;var x=p(A,u);var t=x.ParsedNum;x=p(z,x.Unparsed);var v=x.ParsedNum;x=p(y,x.Unparsed);var w=x.ParsedNum;if(t>0){B=t+v/60+w/3600}else{B=t-v/60-w/3600}B=Math.abs(B);return B}function s(u){var x=String.fromCharCode(176);if(((u[0]).indexOf(x)>0)&&((u[1]).indexOf(x)>0)){var w=o(u[0],x,"'",'"');var v=o(u[1],x,"'",'"');var t=n(w,v);return e(t.lat,t.lng)}else{return{success:false}}}function q(u){for(var t=0;t<=9;t++){if(u.indexOf(t+"D")>0){return 1}}return 0}function r(u){var x=(u[0]).toUpperCase();var w=(u[1]).toUpperCase();var v=q(x)*q(w);if(v>0){var z=o(x,"D","M","S");var y=o(w,"D","M","S");var t=n(z,y);return e(t.lat,t.lng)}else{return{success:false}}}function l(v,t){if(t.length!==2){return{success:false}}var u=k(t);if(!u.success){u=s(t)}if(!u.success){u=r(t)}if(u.success){v.gLatLng=u.latLng;v.callback(v)}return u}var m={process:l};return m})();UTM_LOCATOR=(function(){function l(o,p){if(o.length!==2){return{success:false}}if(h.test(o[0])&&h.test(o[1])){var u=Math.abs(parseFloat(o[0]));var s=Math.abs(parseFloat(o[1]));var r=Math.min(u,s);var q=Math.max(u,s);if(g(r,q)){var t=globalConfig.convertUTMtoLatLng(p,q,r);return e(t.Latitude,t.Longitude)}else{return{success:false}}}else{return{success:false}}}function n(s){var t={success:false};if(s.length!==3){return t}var q=(s[0]).replace(","," ").trim();var p=(s[1]).replace(","," ").trim();var o=(s[2]).replace(","," ").trim();if(h.test(q)&&h.test(p)&&h.test(o)){var u=[Math.abs(parseFloat(q)),Math.abs(parseFloat(p)),Math.abs(parseFloat(o))];u.sort(function(y,x){return y-x});var v=(u[0]).toString();var w=/^\d+$/;if(w.test(v)){if((u[0]>=15)&&(u[0]<=18)){if(g(u[1],u[2])){var r=globalConfig.convertUTMtoLatLng(u[0],u[2],u[1]);return e(r.Latitude,r.Longitude)}}}}return t}function m(q,o){var p=l(o,globalConfig.defaultZone);if(!p.success){p=n(o)}if(p.success){q.gLatLng=p.latLng;q.callback(q)}return p}var k={process:m};return k})();TWP_LOCATOR=(function(){function k(t){if(t.length!==2){return{TWP:"",Lot:"",Con:"",isTWPOnly:false,success:false}}var v=(t[0]).trim().split(/\s+/).join(" ");var q="";var s="";if(((t[1]).indexOf("LOT")>0)&&((t[1]).indexOf("CON")>0)){var r=((t[1]).trim()).split("CON");if((r[0]).length===0){var p=(r[1]).split("LOT");q=(p[0]).trim();s=(p[1]).trim()}else{var o=(r[0]).split("LOT");q=(r[1]).trim();s=(o[1]).trim()}}var u=false;if((q.length===0)&&(s.length===0)){u=true}return{TWP:v,Lot:s,Con:q,isTWPOnly:u,success:true}}function n(s){var r={TWP:"",Lot:"",Con:"",isTWPOnly:false,success:false};if(s.indexOf(" TWP")>0){r=k(s.split(" TWP"))}if(!r.success){if(s.indexOf(" TOWNSHIP")>0){r=k(s.split(" TOWNSHIP"))}}if(!r.success){if(s.indexOf("CANTON ")===0){var u=s.substring(7).trim();var q=u.indexOf(" LOT ");var o=u.indexOf(" CON ");var p=q;if(o<q){p=o}var t=[];if(p===-1){t.push(u);t.push("")}else{t.push(u.substring(0,p));t.push(u.substring(p))}r=k(t)}}return r}function m(s,q){var t=q.join(" ").toUpperCase();var u=n(t);if(u.success){var o=globalConfig.geogTwpService;var v={returnGeometry:true,outFields:[o.latitude,o.longitude]};var p;if(u.isTWPOnly){v.where=o.TWPLayerNameField+" = '"+u.TWP+"'";p=o.TWPLayerID;globalConfig.TWPSearch=true}else{v.where=o.LotLayerNameFields.TownshipField+" = '"+u.TWP+"' AND "+o.LotLayerNameFields.ConField+" = 'CON "+u.Con+"' AND "+o.LotLayerNameFields.LotField+" = 'LOT "+u.Lot+"'";p=o.LotLayerID;globalConfig.TWPLotConSearch=true}var r=new gmaps.ags.Layer(o.url+"/"+p);r.query(v,function(w){if(w.features.length>0){var x=c(w,o.latitude,o.longitude);s.gLatLng=x.gLatLng;s.polylines=x.polylines;s.zoomlevel=(u.isTWPOnly)?globalConfig.twpZoomLevel:globalConfig.lotConcessionZoomLevel;s.callback(s)}else{s.totalCount=0;globalConfig.resultFoundSimple(s)}});return{success:true}}else{return{success:false}}}var l={process:m};return l})();ADDRESS_LOCATOR=(function(){function k(n){if(n.length===2){if(h.test(n[0])&&h.test(n[1])){return true}var s=String.fromCharCode(176);if(((n[0]).indexOf(s)>0)&&((n[1]).indexOf(s)>0)){return true}var o=function(u){for(var t=0;t<=9;t++){if(u.indexOf(t+"D")>0){return 1}}return 0};var r=(n[0]).toUpperCase();var q=(n[1]).toUpperCase();var p=o(r)*o(q);if(p>0){return true}}return false}function m(o,n){if(k(n)){o.totalCount=0;globalConfig.resultFoundSimple(o);return}var q=new google.maps.Geocoder();var p=o.address;if(p.toUpperCase()==="ONTARIO"){o.totalCount=0;globalConfig.resultFoundSimple(o);return}p=globalConfig.regionAddressProcess(p);q.geocode({address:p},function(u,t){if(t===google.maps.GeocoderStatus.OK){var z=u.length;var w=true;for(var v=0;v<z;v++){var B=u[v].geometry.location;var y=globalConfig.failedLocation.positions;var x=globalConfig.failedLocation.difference;var r=false;for(var s=0;s<y.length;s++){var A=Math.abs(B.lat()-y[s][0])+Math.abs(B.lng()-y[s][1]);if(A<x){r=true;break}}if(r){continue}if(b(B.lat(),B.lng())){o.gLatLng=B;o.returnedAddress=u[v].formatted_address.toString();o.callback(o);w=false;break}}if(w){o.totalCount=0;globalConfig.resultFoundSimple(o)}}else{o.totalCount=0;globalConfig.resultFoundSimple(o)}})}var l={process:m};return l})();function j(x){var w=d(x.address,","," ").trim();var o=w.split(/\s+/);var u={success:false};if(typeof(globalConfig.locationServicesList)!=="undefined"){for(var r=0;r<globalConfig.locationServicesList.length;r++){var t=globalConfig.locationServicesList[r];if((!u.success)&&t.isInputFitRequirements(w)){u.success=true;t.returnGeometry=false;if(t.displayPolygon){t.returnGeometry=true}var k=t.fieldsInInfoWindow;k.push(t.latitude);k.push(t.longitude);var n={returnGeometry:t.returnGeometry,where:t.getSearchCondition(w),outFields:k};var s=new gmaps.ags.Layer(t.mapService+"/"+t.layerID);var v=t.getInfoWindow;var l=t.displayPolygon;var q=t.latitude;var p=t.longitude;s.query(n,function(y){var z=0;if(y){z=y.features.length;if(z>0){x.address=v(y.features[0].attributes);if(l){var A=c(y,q,p);x.gLatLng=A.gLatLng;x.polylines=A.polylines;x.callback(x)}else{var B=f(y,q,p);x.gLatLng=B.gLatLng;x.callback(x)}}else{return{success:false}}}else{return{success:false}}})}}}var m=globalConfig.locatorsAvailable;if((!u.success)&&m.latlng){u=LATLNG_LOCATOR.process(x,o)}if((!u.success)&&m.utm){u=UTM_LOCATOR.process(x,o)}if((!u.success)&&m.township){u=TWP_LOCATOR.process(x,o)}if((!u.success)&&m.address){u=ADDRESS_LOCATOR.process(x,o)}}var a={locate:j};return a})();TABS_CALCULATOR=(function(){function getRequiredFieldsFromOneString(infoWindowString,fields){var start=infoWindowString.indexOf("{");var end=infoWindowString.indexOf("}");if((start>=0)&&(end>=0)){var str1=infoWindowString.substring(0,start);var str2=infoWindowString.substring(start+1,end);var str3=infoWindowString.substring(end+1);var funStart=str2.indexOf("(");var funEnd=str2.indexOf(")");if((funStart>=0)&&(funEnd>=0)){var parameters=str2.substring(funStart+1,funEnd);var paraArray=parameters.split(",");for(var j=0;j<paraArray.length;j++){fields.push((paraArray[j]).trim())}}else{fields.push(str2.trim())}infoWindowString=getRequiredFieldsFromOneString(str3,fields)}return fields}function removeConditionInfoWindow(infoWindowString,attributes,start,end){var str1=infoWindowString.substring(0,start);var str2=infoWindowString.substring(start+1,end);var str3=infoWindowString.substring(end+1);var index=str2.indexOf("}");var fieldName=str2.substring(1,index);var str4=str2.substring(index+2);index=str4.indexOf("?");var result="";if(attributes[fieldName]>0){result=str1+str4.substring(index+1)}else{result=str1+str4.substring(0,index)}var start1=str3.indexOf("[");var end1=str3.indexOf("]");if((start1>=0)&&(end1>=0)){str3=removeConditionInfoWindow(str3,attributes,start1,end1)}result=result+str3;return result}function processNA(str){if(typeof(str)==="undefined"){return"N/A"}if(str==="null"){return"N/A"}if(str==="Null"){return"N/A"}return str}function getInfoWindowString(infoWindowString,attributes,start,end){var str1=infoWindowString.substring(0,start);var fieldName=infoWindowString.substring(start+1,end);var str3=infoWindowString.substring(end+1);var dataStr=" ";var funStart=fieldName.indexOf("(");var funEnd=fieldName.indexOf(")");if((funStart>=0)&&(funEnd>=0)){var funName=fieldName.substring(0,funStart);var parameters=fieldName.substring(funStart+1,funEnd);var paraArray=parameters.split(",");funName=funName+"(";for(var j=0;j<paraArray.length;j++){if((paraArray[j]).indexOf("'")===-1){var attrValue=attributes[(paraArray[j]).trim()];attrValue=processNA(attrValue);if(attrValue===null){attrValue="N/A"}if(typeof attrValue==="number"){funName=funName+attrValue}if(typeof attrValue==="string"){if(attrValue.indexOf("'")===-1){funName=funName+"'"+attrValue+"'"}else{if(attrValue.indexOf('"')===-1){funName=funName+'"'+attrValue+'"'}else{funName=funName+'"'+attrValue.replace('"','\\"')+'"'}}}}else{funName=funName+paraArray[j]}if(j<paraArray.length-1){funName=funName+","}}funName=funName+");";dataStr=eval(funName)}else{if(attributes[fieldName]!=="Null"){dataStr=attributes[fieldName]}}var start1=str3.indexOf("{");var end1=str3.indexOf("}");if((start1>=0)&&(end1>=0)){str3=getInfoWindowString(str3,attributes,start1,end1)}var result=str1+dataStr+str3;return result}function getInfoWindowContent(attributes,infoWindowString){var start=infoWindowString.indexOf("[");var end=infoWindowString.indexOf("]");if((start>=0)&&(end>=0)){infoWindowString=removeConditionInfoWindow(infoWindowString,attributes,start,end)}start=infoWindowString.indexOf("{");end=infoWindowString.indexOf("}");if((start>=0)&&(end>=0)){infoWindowString=getInfoWindowString(infoWindowString,attributes,start,end)}return infoWindowString}function getRequiredFields(tabs){var fields=[];for(var i=0;i<tabs.length;i++){var tab=tabs[i];fields=getRequiredFieldsFromOneString(tab.label,fields);fields=getRequiredFieldsFromOneString(tab.content,fields)}return fields.unique()}function getContent(attributes,tabs){var contents=[];for(var i=0;i<tabs.length;i++){var tab=tabs[i];var tabName=getInfoWindowContent(attributes,tab.label);if(tabName.trim().length>1){var tabContent=getInfoWindowContent(attributes,tab.content);contents.push({label:tabName,content:tabContent})}}return contents}var module={getContent:getContent,getRequiredFields:getRequiredFields};return module})();var globalConfig=globalConfig||{};globalConfig.testDivExist=globalConfig.testDivExist||function(a){return(!!document.getElementById(a))};globalConfig.disclaimerDivId=globalConfig.disclaimerDivId||"disclaimer";globalConfig.coordinatesDivId=globalConfig.coordinatesDivId||"coordinates";globalConfig.updateCoordinates=globalConfig.updateCoordinates||function(c,a){var b=globalConfig.convertLatLngtoUTM(c,a);document.getElementById(globalConfig.coordinatesDivId).innerHTML="Latitude:"+c.toFixed(5)+", Longitude:"+a.toFixed(5)+" ("+globalConfig.UTM_ZoneLang+":"+b.Zone+", "+globalConfig.EastingLang+":"+b.Easting+", "+globalConfig.NorthingLang+":"+b.Northing+")<br>"};if(typeof globalConfig.useSystemDefinedInit==="undefined"){globalConfig.useSystemDefinedInit=true}if(typeof globalConfig.allowMultipleIdentifyResult==="undefined"){globalConfig.allowMultipleIdentifyResult=true}if(typeof globalConfig.displayTotalIdentifyCount==="undefined"){globalConfig.displayTotalIdentifyCount=true}if(typeof globalConfig.isCoordinatesVisible==="undefined"){globalConfig.isCoordinatesVisible=true}globalConfig.orgLatitude=globalConfig.orgLatitude||49.764775;globalConfig.orgLongitude=globalConfig.orgLongitude||-85.323214;globalConfig.orgzoomLevel=globalConfig.orgzoomLevel||5;globalConfig.lotConcessionZoomLevel=globalConfig.lotConcessionZoomLevel||14;globalConfig.twpZoomLevel=globalConfig.twpZoomLevel||11;globalConfig.minMapScale=globalConfig.minMapScale||5;globalConfig.maxMapScale=globalConfig.maxMapScale||21;globalConfig.tableID=globalConfig.tableID||"myTable";globalConfig.tableWidth=globalConfig.tableWidth||650;if(!globalConfig.accessible){globalConfig.defaultMapTypeId=globalConfig.defaultMapTypeId||google.maps.MapTypeId.ROADMAP}globalConfig.accessibleTableClassName=globalConfig.accessibleTableClassName||"fishTable";globalConfig.generalTableClassName=globalConfig.generalTableClassName||"tablesorter";globalConfig.accessible=globalConfig.accessible||false;if(globalConfig.accessible){globalConfig.tableClassName=globalConfig.accessibleTableClassName}else{globalConfig.tableClassName=globalConfig.generalTableClassName}globalConfig.mapCanvasDivId=globalConfig.mapCanvasDivId||"map_canvas";globalConfig.opacity=globalConfig.opacity||1;globalConfig.locationTypeSelectionDivId=globalConfig.locationTypeSelectionDivId||"locationType";globalConfig.radiusSelectionDivId=globalConfig.radiusSelectionDivId||"lstRadius";globalConfig.businessTypeParameter=globalConfig.businessTypeParameter||"Business";globalConfig.searchBusinessDivId=globalConfig.searchBusinessDivId||"searchBusiness";globalConfig.searchLocationDivId=globalConfig.searchLocationDivId||"searchLocation";globalConfig.searchInputBoxDivId=globalConfig.searchInputBoxDivId||"map_query";globalConfig.currentMapExtentDivId=globalConfig.currentMapExtentDivId||"currentMapExtent";globalConfig.preInitialize=globalConfig.preInitialize||function(){};globalConfig.postInitialize=globalConfig.postInitialize||function(a){if(document.getElementById(globalConfig.searchBusinessDivId)){document.getElementById(globalConfig.searchBusinessDivId).checked=true}if(document.getElementById(globalConfig.searchLocationDivId)){document.getElementById(globalConfig.searchLocationDivId).checked=false}if(document.getElementById(globalConfig.radiusSelectionDivId)){document.getElementById(globalConfig.radiusSelectionDivId).disabled=true}if(document.getElementById(globalConfig.searchInputBoxDivId)){document.getElementById(globalConfig.searchInputBoxDivId).focus()}};globalConfig.searchChange=globalConfig.searchChange||function(a){if(a===globalConfig.businessTypeParameter){document.getElementById(globalConfig.radiusSelectionDivId).disabled=true}else{document.getElementById(globalConfig.radiusSelectionDivId).disabled=false}};globalConfig.search=globalConfig.search||function(){var c=document.getElementById(globalConfig.searchInputBoxDivId).value.trim();if(c.length===0){return}document.getElementById(globalConfig.queryTableDivId).innerHTML="";MOEMAP.clearOverlays();if(document.getElementById(globalConfig.searchBusinessDivId).checked){c=c.toUpperCase();c=globalConfig.replaceChar(c,"'","''");c=globalConfig.replaceChar(c,globalConfig.u2019Lang,"''");var b=globalConfig.attributeSearchItems;MOEMAP.queryLayerWithFuzzyMatch(b[0].field,c);return}if(document.getElementById(globalConfig.searchLocationDivId).checked){var a=document.getElementById(globalConfig.radiusSelectionDivId).value;MOEMAP.queryLayerWithLocationRadius(c,a)}};globalConfig.extraImageService=globalConfig.extraImageService||{id:"arcgis",name:"ESRI",url:"http://server.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer",visible:true};globalConfig.entsub=globalConfig.entsub||function(a){if(a&&a.which===13){globalConfig.search()}else{return true}};globalConfig.searchTheMapDivId=globalConfig.searchTheMapDivId||"searchTheMap";globalConfig.searchHelpDivId=globalConfig.searchHelpDivId||"searchHelp";globalConfig.informationDivId=globalConfig.informationDivId||"information";globalConfig.createTablesInfoWindows=globalConfig.createTablesInfoWindows||function(b){var a=function(c){return{label:c.label,head:"<table class='tabtable'><tr><th>"+c.content.map(function(d){return d.name}).join("</th><th>")+"</th></tr>",content:"<tr><td>"+c.content.map(function(d){return d.value}).join("</td><td>")+"</td></tr>",tail:"</table>"}};return b.map(a)};globalConfig.createTableBelowMap=globalConfig.createTableBelowMap||function(a){return{head:a.title+'<table id="'+globalConfig.tableID+'" class="'+globalConfig.tableClassName+'" width="'+globalConfig.tableWidth+'" border="0" cellpadding="0" cellspacing="1"><thead><tr><th><center>'+a.content.map(function(c){return c.name}).join("</center></th><th><center>")+"</center></th></tr></thead><tbody>",content:"<tr><td>"+a.content.map(function(c){return c.value}).join("</td><td>")+"</td></tr>",tail:"</tbody></table>"}};globalConfig.noCoordinatesTableID=globalConfig.noCoordinatesTableID||"noCoordinatesTable";globalConfig.createNoCoordinatesTableBelowMap=globalConfig.createNoCoordinatesTableBelowMap||function(a){return{head:globalConfig.noCoordinatesTableTitleLang+'<table id="'+globalConfig.noCoordinatesTableID+'" class="'+globalConfig.tableClassName+'" width="'+globalConfig.tableWidth+'" border="0" cellpadding="0" cellspacing="1"><thead><tr><th><center>'+a.content.map(function(c){return c.name}).join("</center></th><th><center>")+"</center></th></tr></thead><tbody>",content:"<tr><td>"+a.content.map(function(c){return c.value}).join("</td><td>")+"</td></tr>",tail:"</tbody></table>"}};globalConfig.chooseLang=globalConfig.chooseLang||function(b,a){return(globalConfig.language==="EN")?b:a};if((globalConfig.searchableFieldsList)&&(!globalConfig.searchHelpTxt)){globalConfig.searchHelpTxt=globalConfig.youMaySearchByLang;for(var i=0;i<globalConfig.searchableFieldsList.length-1;i++){globalConfig.searchHelpTxt=globalConfig.searchHelpTxt+"<strong>"+globalConfig.chooseLang(globalConfig.searchableFieldsList[i].en,globalConfig.searchableFieldsList[i].fr)+"</strong>, "}globalConfig.searchHelpTxt=globalConfig.searchHelpTxt+"<strong>"+globalConfig.chooseLang(globalConfig.searchableFieldsList[i].en,globalConfig.searchableFieldsList[i].fr)+"</strong> "+globalConfig.seeHelpForAdvancedOptionsLang}globalConfig.searchControlHTMLGenerator=globalConfig.searchControlHTMLGenerator||function(){return'<div id="searchTheMap"></div><div id="searchHelp"></div><br>			<label class="element-invisible" for="map_query">'+globalConfig.chooseLang("Search the map","Recherche carte interactive")+'</label>			<input id="map_query" type="text" title="'+globalConfig.chooseLang("Search term","Terme de recherche")+'" maxlength="100" size="50" onkeypress="return globalConfig.entsub(event)"></input>			<label class="element-invisible" for="search_submit">'+globalConfig.chooseLang("Search","Recherche")+'</label>			<input id="search_submit" type="submit" title="'+globalConfig.chooseLang("Search","Recherche")+'" onclick="globalConfig.search()" value="'+globalConfig.chooseLang("Search","Recherche")+'"></input>			<br/>			<input id="currentMapExtent" type="checkbox" name="currentExtent" title="'+globalConfig.chooseLang("Current Map Display","Étendue de la carte courante")+'" /> <label for="currentExtent" class=\'option\'>'+globalConfig.chooseLang("Search current map display only","\u00c9tendue de la carte courante")+'</label>			<div id="information"></div>'};if(!globalConfig.hasOwnProperty("searchControlHTML")){globalConfig.searchControlHTML=globalConfig.searchControlHTMLGenerator()}INITIALIZATION=(function(){function a(){if((!globalConfig.hasOwnProperty("queryLayerList"))&&globalConfig.hasOwnProperty("identifyMultiplePolygonLayersServicesTemplate")){globalConfig.queryLayerList=globalConfig.identifyMultiplePolygonLayersServicesTemplate.layerList;if(globalConfig.identifyMultiplePolygonLayersServicesTemplate.hasOwnProperty("merge")){globalConfig.mergeFunction=globalConfig.identifyMultiplePolygonLayersServicesTemplate.merge}}else{var h=function(l){var n=function(t,v){var o=t.indexOf("{");var q=t.indexOf("}");if((o>=0)&&(q>=0)){var u=t.substring(0,o);var s=t.substring(o+1,q);var p=t.substring(q+1);var w=s.indexOf("(");var x=s.indexOf(")");if((w>=0)&&(x>=0)){var z=s.substring(w+1,x);var y=z.split(",");for(var r=0;r<y.length;r++){v.push((y[r]).trim())}}else{v.push(s.trim())}t=n(p,v)}return v};var j=[];for(var k=0;k<l.length;k++){var m=l[k];j=n(m.label,j);j=n(m.content,j)}return j.unique()};for(var e=0;e<globalConfig.queryLayerList.length;e++){var g=globalConfig.queryLayerList[e];if((!g.hasOwnProperty("tabsTemplate"))&&g.hasOwnProperty("tabsTableTemplate")){g.tabsTemplate=globalConfig.createTablesInfoWindows(g.tabsTableTemplate)}var f=[];if(g.hasOwnProperty("tabsTemplate")){f=h(g.tabsTemplate)}if((!g.hasOwnProperty("tableTemplate"))&&g.hasOwnProperty("tableSimpleTemplate")){g.tableTemplate=globalConfig.createTableBelowMap(g.tableSimpleTemplate);g.noCoordinatesTableTemplate=globalConfig.createNoCoordinatesTableBelowMap(g.tableSimpleTemplate)}if(g.hasOwnProperty("tableTemplate")){var d=h([{label:globalConfig.InformationLang,content:g.tableTemplate.content}]);if(f.length===0){f=d.unique()}else{f=f.concat(d).unique()}}globalConfig.queryLayerList[e].outFields=f}}}function c(){var h;if(typeof(globalConfig.preInitialize)!=="undefined"){globalConfig.preInitialize()}if(typeof(globalConfig.selfDefinedInitialize)!=="undefined"){globalConfig.selfDefinedInitialize()}else{a();if(!globalConfig.accessible){var e={zoom:globalConfig.orgzoomLevel,center:new google.maps.LatLng(globalConfig.orgLatitude,globalConfig.orgLongitude),scaleControl:true,streetViewControl:true,mapTypeId:globalConfig.defaultMapTypeId};var j=globalConfig.extraImageService;if(j.visible){e.mapTypeControlOptions={mapTypeIds:[j.id,google.maps.MapTypeId.ROADMAP,google.maps.MapTypeId.SATELLITE,google.maps.MapTypeId.HYBRID,google.maps.MapTypeId.TERRAIN]}}h=new google.maps.Map(document.getElementById(globalConfig.mapCanvasDivId),e);if(j.visible){var f=new gmaps.ags.MapType(j.url,{name:j.name});h.mapTypes.set(j.id,f)}if(typeof(globalConfig.url)!=="undefined"){var d=new gmaps.ags.MapService(globalConfig.url);var g=new gmaps.ags.MapOverlay(d,{opacity:globalConfig.opacity});g.setMap(h)}if(typeof(globalConfig.tileLayerService)!=="undefined"){var f=new gmaps.ags.MapType(globalConfig.tileLayerService.url,{name:globalConfig.tileLayerService.name,opacity:globalConfig.tileLayerService.opacity});h.overlayMapTypes.insertAt(0,f)}MOEMAP.init(h);TOOLSLEGEND.init(h);globalConfig.updateCoordinates(globalConfig.orgLatitude,globalConfig.orgLongitude)}if(typeof globalConfig.searchControlHTML!=="undefined"){globalConfig.searchControlDivId=globalConfig.searchControlDivId||"searchControl";if(globalConfig.testDivExist(globalConfig.searchControlDivId)){document.getElementById(globalConfig.searchControlDivId).innerHTML=globalConfig.searchControlHTML}}if(typeof globalConfig.otherInfoHTML!=="undefined"){globalConfig.otherInfoDivId=globalConfig.otherInfoDivId||"otherInfo";if(globalConfig.testDivExist(globalConfig.otherInfoDivId)){document.getElementById(globalConfig.otherInfoDivId).innerHTML=globalConfig.otherInfoHTML}}if(typeof globalConfig.applicationTitle!=="undefined"){globalConfig.applicationTitleDivId=globalConfig.applicationTitleDivId||"applicationTitle";if(globalConfig.testDivExist(globalConfig.applicationTitleDivId)){document.getElementById(globalConfig.applicationTitleDivId).innerHTML=globalConfig.applicationTitle}}if(globalConfig.testDivExist(globalConfig.searchTheMapDivId)){document.getElementById(globalConfig.searchTheMapDivId).innerHTML="<h2>"+globalConfig.SearchInteractiveMapLang+"</h2>"}if(globalConfig.testDivExist(globalConfig.searchHelpDivId)){document.getElementById(globalConfig.searchHelpDivId).innerHTML=globalConfig.searchHelpTxt}if((typeof(globalConfig.disclaimerLang)!=="undefined")&&globalConfig.displayDisclaimer&&globalConfig.testDivExist(globalConfig.disclaimerDivId)){document.getElementById(globalConfig.disclaimerDivId).innerHTML=globalConfig.disclaimerLang}}if(typeof(globalConfig.postInitialize)!=="undefined"){globalConfig.postInitialize(h)}}var b={init:c};return b})();if(globalConfig.useSystemDefinedInit){window.onload=INITIALIZATION.init}var globalConfig=globalConfig||{};globalConfig.imageURL="http://files.ontariogovernment.ca/moe_mapping/mapping/js/MOEMap/images/";globalConfig.legend=globalConfig.legend||{available:false,url:globalConfig.imageURL+"legend.png",size:{width:270,height:81},location:{ratioX:0.01,ratioY:0.25}};globalConfig.pointBufferTool=globalConfig.pointBufferTool||{available:true,upIcon:globalConfig.imageURL+"Bptu.png",downIcon:globalConfig.imageURL+"Bptd.png",size:{width:31,height:31},location:{ratioX:0.12,ratioY:0.98}};TOOLSLEGEND=(function(){var g,e;var a;function k(t){var m=globalConfig.pointBufferTool;var l=a.getBounds();var s=l.getSouthWest();var p=l.getNorthEast();var o=p.lat()-s.lat();var q=p.lng()-s.lng();var r="";if(t){r=m.downIcon}else{r=m.upIcon}var n=new google.maps.MarkerImage(r,new google.maps.Size(m.size.width,m.size.height),new google.maps.Point(0,0),new google.maps.Point(0,0),new google.maps.Size(m.size.width,m.size.height));if(g){g.setMap(null)}g=new google.maps.Marker({position:new google.maps.LatLng(s.lat()+m.location.ratioY*o,s.lng()+m.location.ratioX*q),icon:n,title:globalConfig.selectTooltip,map:a})}function h(){var l=globalConfig.pointBufferTool;if(g&&(g.icon.url===l.downIcon)){return true}return false}function f(l,p,o){var n=globalConfig.legend;if(n.available){var q=new google.maps.LatLng(l.lat()+n.location.ratioY*p,l.lng()+n.location.ratioX*o);if(e){e.setMap(null)}var m=new google.maps.MarkerImage(n.url,new google.maps.Size(n.size.width,n.size.height),new google.maps.Point(0,0),new google.maps.Point(0,0),new google.maps.Size(n.size.width,n.size.height));e=new google.maps.Marker({position:q,icon:m,map:a})}}function b(){var m=globalConfig.pointBufferTool;if(typeof(m)!=="undefined"){if(m.available){k(false);var l="";(function(n,o){google.maps.event.addListener(o,"click",function(){k(true)})})(l,g)}}}function d(){var m=a.getBounds();var l=m.getSouthWest();var p=m.getNorthEast();var o=p.lat()-l.lat();var n=p.lng()-l.lng();f(l,o,n);b()}function j(l){a=l;google.maps.event.addListener(a,"bounds_changed",d)}var c={init:j,isPointBufferToolSelected:h,setPointBufferTool:k};return c})();var globalConfig=globalConfig||{};globalConfig.drawingCircleMessage=globalConfig.drawingCircleMessage||function(c,b,a){document.getElementById(globalConfig.informationDivId).innerHTML=globalConfig.searchCenterLang+" (latitude:"+c.toFixed(6)+", longitude:"+b.toFixed(6)+"), "+globalConfig.searchRadiusLang+" ("+a.toFixed(2)+" "+globalConfig.searchKMLang+")"};globalConfig.totalFeatureReturned=globalConfig.totalFeatureReturned||function(a){return globalConfig.totalFeatureReturnedLang+": <strong>"+a+"</strong>"};globalConfig.totalFeatureReturnedOnlyOneDisplayed=globalConfig.totalFeatureReturnedOnlyOneDisplayed||function(a){return globalConfig.totalFeatureReturnedLang+": <strong>"+a+"</strong>"+globalConfig.only1DisplayedLang};globalConfig.maxQueryReturn=globalConfig.maxQueryReturn||500;globalConfig.resultFound=globalConfig.resultFound||function(b,a){var c={totalCount:a};globalConfig.resultFoundSimple(c)};globalConfig.resultFoundSimple=globalConfig.resultFoundSimple||function(d){var c=d.searchString;var b=d.totalCount;var f="";if(typeof(d.withinExtent)!=="undefined"){f=" "+(d.withinExtent?globalConfig.inCurrentMapExtentLang:globalConfig.inGobalRegionLang)}var c=" ";if(typeof(d.searchString)!=="undefined"){c=" "+globalConfig.forLang+" <strong>"+d.searchString+"</strong> "}var e="";if(d.hasOwnProperty("invalidCount")&&(d.invalidCount>0)){var a=(d.invalidCount===1)?globalConfig.ResultDoesNotHaveValidCoordinates:globalConfig.ResultsDoNotHaveValidCoordinates;if(b===0){e=globalConfig.yourSearchLang+c+globalConfig.returnedNoResultLang+f+". "+globalConfig.pleaseRefineSearchLang+"."}else{if(b===1){e=globalConfig.oneResultFoundLang+c+f+"."+globalConfig.ThisResultDoesNotHaveValidCoordinates}else{if(b>=globalConfig.maxQueryReturn){e=globalConfig.moreThanLang+" "+globalConfig.maxQueryReturn+" "+globalConfig.resultsFoundLang+c+f+". "+globalConfig.onlyLang+" "+globalConfig.maxQueryReturn+" "+globalConfig.returnedLang+". "+globalConfig.seeHelpLang+"."+globalConfig.AmongReturnedResults+", "+d.invalidCount+a}else{e=b+" "+globalConfig.resultsFoundLang+c+f+". "+globalConfig.AmongReturnedResults+", "+d.invalidCount+a}}}}else{if(b===0){e=globalConfig.yourSearchLang+c+globalConfig.returnedNoResultLang+f+". "+globalConfig.pleaseRefineSearchLang+"."}else{if(b===1){e=globalConfig.oneResultFoundLang+c+f+"."}else{if(b>=globalConfig.maxQueryReturn){e=globalConfig.moreThanLang+" "+globalConfig.maxQueryReturn+" "+globalConfig.resultsFoundLang+c+f+". "+globalConfig.onlyLang+" "+globalConfig.maxQueryReturn+" "+globalConfig.returnedLang+". "+globalConfig.seeHelpLang+"."}else{e=b+" "+globalConfig.resultsFoundLang+c+f+"."}}}}document.getElementById(globalConfig.informationDivId).innerHTML="<i>"+e+"</i>"};globalConfig.noResultFound=globalConfig.noResultFound||function(){document.getElementById(globalConfig.informationDivId).innerHTML="<i>"+globalConfig.noResultFoundMsg+"</i>"};globalConfig.searchInProgress=globalConfig.searchInProgress||function(){document.getElementById(globalConfig.informationDivId).innerHTML="<i>"+globalConfig.searchingLang+"</i>"};globalConfig.maxQueryZoomLevel=globalConfig.maxQueryZoomLevel||17;globalConfig.maxQueryZoomLevelTWPSearch=globalConfig.maxQueryZoomLevelTWPSearch||11;globalConfig.maxQueryZoomLevelTWPLotConSearch=globalConfig.maxQueryZoomLevelTWPLotConSearch||14;globalConfig.queryTableDivId=globalConfig.queryTableDivId||"query_table";if(typeof globalConfig.usejQueryUITable==="undefined"){globalConfig.usejQueryUITable=true}if(globalConfig.usejQueryUITable&&(!globalConfig.accessible)&&(!!yepnope)){yepnope({load:"http://files.ontario.ca/moe_mapping/mapping/js/MOEMap/css/jquery.dataTables.css",callback:function(){}});yepnope({load:"http://files.ontario.ca/moe_mapping/mapping/js/MOEMap/js/jquery.dataTables.js",callback:function(){}})}if(typeof globalConfig.usePredefinedMultipleTabs==="undefined"){globalConfig.usePredefinedMultipleTabs=true}if(globalConfig.usePredefinedMultipleTabs&&(!globalConfig.accessible)&&(!!yepnope)){yepnope({load:"http://files.ontario.ca/moe_mapping/mapping/js/MOEMap/css/multipletabs.css",callback:function(){}});yepnope({load:"http://files.ontario.ca/moe_mapping/mapping/js/MOEMap/js/closure-library-multipletabs-min.js",callback:function(){}})}globalConfig.searchedLocationIcon=globalConfig.searchedLocationIcon||"http://gmaps-samples.googlecode.com/svn/trunk/markers/blue/blank.png";globalConfig.twpBoundary=globalConfig.twpBoundary||{color:"#8583f3",opacity:1,weight:4};globalConfig.pointBuffer=globalConfig.pointBuffer||{color:"#FF0000",opacity:1,weight:2};globalConfig.identifyMarkerRedTearDrop=globalConfig.identifyMarkerRedTearDrop||false;globalConfig.identifyRadiusZoomLevelList=globalConfig.identifyRadiusZoomLevelList||{21:0.001,20:0.001,19:0.002,18:0.003,17:0.005,16:0.01,15:0.02,14:0.05,13:0.08,12:0.16,11:0.3,10:0.6,9:1.2,8:2.4,7:4.8,6:9.6,5:20,4:40,3:80,2:160,1:320};globalConfig.preIdentifyCallbackName=globalConfig.preIdentifyCallbackName||"Wells";globalConfig.preIdentifyCallbackList=globalConfig.preIdentifyCallbackList||{Wells:function(b){var a=globalConfig.identifyRadiusZoomLevelList[b.map.getZoom()];var e=b.layerList[b.currentLayerId];var c=globalConfig.calculateCirclePolyline(b.gLatLng,a*1000);var d={returnGeometry:false,outFields:e.outFields,geometry:new google.maps.Polygon({paths:c.getPath()}),geometryType:"esriGeometryPolygon"};return d},SWPLocator:function(a){var c=a.layerList[a.currentLayerId];var b={returnGeometry:c.hasOwnProperty("returnGeometry")?c.returnGeometry:false,geometryType:"esriGeometryPoint",geometry:a.gLatLng,outFields:c.returnFields};return b}};globalConfig.preIdentifyCallback=globalConfig.preIdentifyCallback||globalConfig.preIdentifyCallbackList[globalConfig.preIdentifyCallbackName];globalConfig.createControllableInfoWindowContent=function(b){var a=document.createElement("div");a.style.width=globalConfig.infoWindowWidth;if(globalConfig.hasOwnProperty("infoWindowHeight")){a.style.height=globalConfig.infoWindowHeight}a.innerHTML=b;return a};globalConfig.postIdentifyCallbackName=globalConfig.postIdentifyCallbackName||"Wells";globalConfig.postIdentifyCallbackList=globalConfig.postIdentifyCallbackList||{Wells:function(c){var b=Array.range(0,c.layerList.length-1).reduce(function(e,f){var d=c.layerList[f].result;if(d.hasOwnProperty("features")){return e.concat(d.features)}else{return e}},[]);if(b.length===0){return}var a=globalConfig.calculateMulitpleTabsOneFeature(b,c.layerList[0].tabsTemplate);MOEMAP.openInfoWindow(c.gLatLng,a)},SportFish:function(e){var d=Array.range(0,e.layerList.length-1).reduce(function(g,h){var f=e.layerList[h].result;if(f.hasOwnProperty("features")){return g.concat(f.features)}else{return g}},[]);if(d.length===0){return}var c=e.layerList[0].tabsTemplate;var b=TABS_CALCULATOR.getContent(d[0].attributes,c);var a=globalConfig.createControllableInfoWindowContent(b[0].content);MOEMAP.openInfoWindow(e.gLatLng,a)},SWPLocatorReverseGeocoding:function(a){if(globalConfig.avoidReverseGeocoding){globalConfig.avoidReverseGeocoding=false;globalConfig.postIdentifyCallbackList.SWPLocator(a)}else{var b=new google.maps.Geocoder();var c=a.gLatLng;b.geocode({address:c.lat()+","+c.lng()},function(e,d){if(d===google.maps.GeocoderStatus.OK){globalConfig.returnedAddress=e[0].formatted_address.toString();globalConfig.postIdentifyCallbackList.SWPLocator(a)}else{alert("Geocode was not successful for the following reason: "+d)}})}},SWPLocator:function(g){MOEMAP.clearOverlays();var h=g.layerList;var a="";if(g.hasOwnProperty("mergeFunction")){a=g.mergeFunction(g.gLatLng)}else{a=Array.range(0,h.length-1).map(function(j){var k=h[j]["result"].features;if(k.length>0){return Array.range(0,k.length-1).map(function(l){return h[j].callback(k[l].attributes)+"<br>"}).join("")}else{return""}}).join("")}var e=globalConfig.identifyMarkerRedTearDrop?(new google.maps.Marker({position:g.gLatLng,draggable:true})):(new google.maps.Marker({position:g.gLatLng,icon:globalConfig.searchedLocationIcon,draggable:true}));MOEMAP.addOverlay(e);a=globalConfig.createControllableInfoWindowContent(a);MOEMAP.openInfoWindow(g.gLatLng,a);(function(j,k){google.maps.event.addListener(k,"click",function(){MOEMAP.openInfoWindow(k.getPosition(),j)})})(a,e);google.maps.event.addListener(e,"dragend",function(){MOEMAP.clearOverlays();if(document.getElementById(globalConfig.searchInputBoxDivId)){document.getElementById(globalConfig.searchInputBoxDivId).value="";document.getElementById(globalConfig.searchInputBoxDivId).focus()}if(document.getElementById(globalConfig.queryTableDivId)){document.getElementById(globalConfig.queryTableDivId).innerHTML=""}var j=new google.maps.Geocoder();var k=e.getPosition();g.map.setCenter(k);j.geocode({address:k.lat()+","+k.lng()},function(m,l){if(l===google.maps.GeocoderStatus.OK){globalConfig.returnedAddress=m[0].formatted_address.toString();MOEMAP.mouseClickHandler({latLng:k})}else{alert("Geocode was not successful for the following reason: "+l)}})});for(var d=0;d<h.length;d++){if(h[d].hasOwnProperty("displayPolygon")&&(h[d].displayPolygon)){var f=h[d]["result"].features;for(var c=0;c<f.length;c++){var b=f[c].geometry[0];b.setOptions(h[d].style);MOEMAP.addOverlay(b)}}}if(globalConfig.testDivExist(globalConfig.queryTableDivId)){document.getElementById(globalConfig.queryTableDivId).innerHTML="<br>"+a.innerHTML}}};globalConfig.postIdentifyCallback=globalConfig.postIdentifyCallback||globalConfig.postIdentifyCallbackList[globalConfig.postIdentifyCallbackName];globalConfig.preBufferCallbackName=globalConfig.preBufferCallbackName||"Wells";globalConfig.preBufferCallbackList=globalConfig.preBufferCallbackList||{Wells:function(c){var a=c.radius;var b=globalConfig.createMarker(c.gLatLng,""+c.gLatLng.lat().toFixed(5)+", "+c.gLatLng.lng().toFixed(5),globalConfig.searchedLocationIcon);MOEMAP.addOverlay(b);var g=c.layerList[c.currentLayerId];var e=globalConfig.calculateCirclePolyline(c.gLatLng,a*1000);var d=globalConfig.calculatePolylineBounds(e);globalConfig.setMapBound(c.map,d);MOEMAP.addOverlay(e);var f={returnGeometry:true,outFields:g.outFields,geometry:new google.maps.Polygon({paths:e.getPath()}),geometryType:"esriGeometryPolygon"};if(c.hasOwnProperty("where")){f.where=c.where}return f}};globalConfig.preBufferCallback=globalConfig.preBufferCallback||globalConfig.preBufferCallbackList[globalConfig.preBufferCallbackName];globalConfig.postBufferCallbackName=globalConfig.postBufferCallbackName||"Wells";globalConfig.postBufferCallbackList=globalConfig.postBufferCallbackList||{Wells:function(c){var b=Array.range(0,c.layerList.length-1).reduce(function(e,f){var d=c.layerList[f].result;if(d.hasOwnProperty("features")){return e.concat(d.features)}else{return e}},[]);if(b.length===0){c.totalCount=0;globalConfig.resultFoundSimple(c);return}globalConfig.addMarkers(b,c.layerList[0].tabsTemplate);var a={coordinatesTable:c.layerList[0].tableTemplate,noCoordinatesTable:c.layerList[0].noCoordinatesTableTemplate};globalConfig.renderTable(b,a,c.gLatLng);c.totalCount=b.length;globalConfig.resultFoundSimple(c)}};globalConfig.postBufferCallback=globalConfig.postBufferCallback||globalConfig.postBufferCallbackList[globalConfig.postBufferCallbackName];globalConfig.addMarkers=globalConfig.addMarkers||function(f,e){var d=globalConfig.calculateClusters(f);for(var a=0;a<d.length;a++){var g=d[a].gLatLng;var c=globalConfig.calculateMulitpleTabsOneFeature(d[a].list,e);var b=new google.maps.Marker({position:g});(function(j,h){google.maps.event.addListener(h,"click",function(){MOEMAP.openInfoWindow(h.getPosition(),j)})})(c,b);MOEMAP.addOverlay(b)}};globalConfig.addMarkersSimple=globalConfig.addMarkersSimple||function(f,e){for(var a=0;a<f.length;a++){var g=f[a].geometry[0].getPosition();var d=TABS_CALCULATOR.getContent(f[a].attributes,e);var c=globalConfig.createControllableInfoWindowContent(d[0].content);var b=new google.maps.Marker({position:g});(function(j,h){google.maps.event.addListener(h,"click",function(){MOEMAP.openInfoWindow(h.getPosition(),j)})})(c,b);MOEMAP.addOverlay(b)}};globalConfig.renderTable=function(b,m,d){var c=m.coordinatesTable;var k=m.noCoordinatesTable;var a=b.filter(globalConfig.validFeaturesFilter);var h=b.filter(function(q){return !globalConfig.validFeaturesFilter(q)});var f=c.head;var p=(typeof(d)!=="undefined");if(p){var l=c.head.split("<table");if(l.length===2){f=l[0]+globalConfig.distanceFieldNote+"<table"+l[1]}var l=f.split("</tr>");if(l.length===2){f=l[0]+"<th><center>"+globalConfig.distanceLang+"</center></th></tr>"+l[1]}}var n=function(s,A,u){var z="";var B=s.length;for(var w=0;w<B;w++){var r=s[w];var q=TABS_CALCULATOR.getContent(r.attributes,[{label:globalConfig.InformationLang,content:u}]);var v=q[0].content;var t=r.geometry[0].getPosition();if(A){var y=v.split("</tr>");v=y[0]+"<td>"+(google.maps.geometry.spherical.computeDistanceBetween(t,d)/1000).toFixed(2)+"</td></tr>"}z=z+v}return z};var o=(a.length===0)?"":(f+n(a,p,c.content)+c.tail+"<br><br><br>");o=o+((h.length===0)?"":(k.head+n(h,false,k.content)+k.tail+"<br><br><br>"+globalConfig.whyAmISeeingThisLang));document.getElementById(globalConfig.queryTableDivId).innerHTML=o;var j=globalConfig.tableID;if(globalConfig.usejQueryUITable){var e={bJQueryUI:true,sPaginationType:"full_numbers"};if(globalConfig.language!=="EN"){e.oLanguage=globalConfig.dataTableLang}if(p){var g=f.split("</th><th>");e.aaSorting=[[g.length-1,"asc"]]}$("#"+j).dataTable(e);$("#"+globalConfig.noCoordinatesTableID).dataTable(e)}};globalConfig.preConditionsCallbackName=globalConfig.preConditionsCallbackName||"Wells";globalConfig.preConditionsCallbackList=globalConfig.preConditionsCallbackList||{Wells:function(a){var d=a.layerList[a.currentLayerId];var c={returnGeometry:(globalConfig.accessible)?false:true,outFields:d.outFields,where:a.where};if(a.withinExtent){var b=function(k){var g=k.getBounds();var e=g.getSouthWest();var j=g.getNorthEast();var h=new google.maps.LatLng(e.lat(),j.lng());var f=new google.maps.LatLng(j.lat(),e.lng());return new google.maps.Polygon({paths:[e,h,j,f,e]})};c.geometry=b(a.map)}return c}};globalConfig.preConditionsCallback=globalConfig.preConditionsCallback||globalConfig.preConditionsCallbackList[globalConfig.preConditionsCallbackName];globalConfig.validFeaturesFilter=globalConfig.validFeaturesFilter||function(a){var b=a.geometry[0].position;return(b.lat()>0.0001&&b.lng()<0.0001)};globalConfig.postConditionsCallbackName=globalConfig.postConditionsCallbackName||"Wells";globalConfig.postConditionsCallbackList=globalConfig.postConditionsCallbackList||{Wells:function(e){var d=Array.range(0,e.layerList.length-1).reduce(function(h,j){var g=e.layerList[j].result;if(g.hasOwnProperty("features")){return h.concat(g.features)}else{return h}},[]);if(d.length===0){e.totalCount=0;globalConfig.resultFoundSimple(e);if(e.requireGeocode){MOEMAP.geocodeAddress(e)}return}var b=d.filter(globalConfig.validFeaturesFilter);var a=d.filter(function(g){return !globalConfig.validFeaturesFilter(g)});e.totalCount=d.length;e.validCount=b.length;e.invalidCount=a.length;globalConfig.resultFoundSimple(e);if((!e.withinExtent)&&(b.length>0)){var f=globalConfig.calculatePointsBounds(b);globalConfig.setMapBound(e.map,f)}if(globalConfig.usePredefinedMultipleTabs){globalConfig.addMarkers(b,e.layerList[0].tabsTemplate)}else{globalConfig.addMarkersSimple(b,e.layerList[0].tabsTemplate)}if(e.layerList[0].hasOwnProperty("tableTemplate")){var c={coordinatesTable:e.layerList[0].tableTemplate,noCoordinatesTable:e.layerList[0].noCoordinatesTableTemplate};globalConfig.renderTable(d,c)}},AccessibleWells:function(c){var b=Array.range(0,c.layerList.length-1).reduce(function(f,g){var e=c.layerList[g].result;if(e.hasOwnProperty("features")){return f.concat(e.features)}else{return f}},[]);c.totalCount=b.length;globalConfig.resultFoundSimple(c);if(b.length===0){return}var a=c.layerList[0].tableTemplate;var d=a.head+Array.range(0,b.length-1).reduce(function(e,g){var f=TABS_CALCULATOR.getContent(b[g].attributes,[{label:globalConfig.InformationLang,content:a.content}]);var h=f[0].content;if(g%2===1){h=globalConfig.replaceChar(h,"<td>","<td  class='shaded'>")}return e+h},"")+a.tail;document.getElementById(globalConfig.queryTableDivId).innerHTML=d},SportFish:function(b){var a=Array.range(0,b.layerList.length-1).reduce(function(e,f){var d=b.layerList[f].result;if(d.hasOwnProperty("features")){return e.concat(d.features)}else{return e}},[]);if(a.length===0){if(b.requireGeocode){MOEMAP.geocodeAddress(b)}else{b.totalCount=0;globalConfig.resultFoundSimple(b)}return}b.totalCount=a.length;globalConfig.resultFoundSimple(b);if(!b.withinExtent){var c=globalConfig.calculatePointsBounds(a);globalConfig.setMapBound(b.map,c)}globalConfig.addMarkersSimple(a,b.layerList[0].tabsTemplate)}};globalConfig.postConditionsCallback=globalConfig.postConditionsCallback||globalConfig.postConditionsCallbackList[globalConfig.postConditionsCallbackName];globalConfig.addressGeocodingCallbackName=globalConfig.addressGeocodingCallbackName||"Wells";globalConfig.addressGeocodingCallbackList=globalConfig.addressGeocodingCallbackList||{Wells:function(c){var b=c.hasOwnProperty("withinExtent")?c.withinExtent:false;var d=c.map;if(b&&(!c.map.getBounds().contains(c.gLatLng))){c.totalCount=0;globalConfig.resultFoundSimple(c);return}if(c.hasOwnProperty("polylines")){MOEMAP.addPolylinesToMap(c.polylines)}var a=globalConfig.createMarker(c.gLatLng,c.searchString,globalConfig.searchedLocationIcon);MOEMAP.addOverlay(a);if(!b){c.map.setCenter(c.gLatLng);if(c.hasOwnProperty("zoomlevel")){c.map.setZoom(c.zoomlevel)}else{if(c.map.getZoom()<=globalConfig.maxQueryZoomLevel){c.map.setZoom(globalConfig.maxQueryZoomLevel)}}}c.totalCount=1;globalConfig.resultFoundSimple(c)},SWPLocator:function(a){var b=a.map;if(a.hasOwnProperty("polylines")){MOEMAP.addPolylinesToMap(a.polylines)}var c=a.gLatLng;if(a.hasOwnProperty("returnedAddress")){globalConfig.returnedAddress=a.returnedAddress}else{globalConfig.returnedAddress=a.address}b.setCenter(c);if(a.hasOwnProperty("zoomLevel")){b.setZoom(a.zoomLevel)}else{if(b.getZoom()<=globalConfig.maxQueryZoomLevel){b.setZoom(globalConfig.maxQueryZoomLevel)}}MOEMAP.mouseClickHandler({latLng:c})}};globalConfig.addressGeocodingCallback=globalConfig.addressGeocodingCallback||globalConfig.addressGeocodingCallbackList[globalConfig.addressGeocodingCallbackName];globalConfig.calculatePointsBounds=globalConfig.calculatePointsBounds||function(c){var d=new google.maps.LatLngBounds();var b=c.length;for(var a=0;a<b;a++){var e=c[a].geometry[0].getPosition();d.extend(e)}return d};globalConfig.setMapBound=globalConfig.setMapBound||function(b,a){b.fitBounds(a);var c=globalConfig.maxQueryZoomLevel;if(globalConfig.TWPSearch){c=globalConfig.maxQueryZoomLevelTWPSearch;globalConfig.TWPSearch=false}else{if(globalConfig.TWPLotConSearch){c=globalConfig.maxQueryZoomLevelTWPLotConSearch;globalConfig.TWPLotConSearch=false}}if(b.getZoom()>c){b.setZoom(c)}};globalConfig.calculateClusters=globalConfig.calculateClusters||function(c){var l=c.length;var e=[];for(var h=0;h<l;h++){var b=c[h];var d=b.geometry[0].getPosition();if(Math.abs(d.lng())+Math.abs(d.lat())>0.001){var g=false;for(var f=0;f<e.length;f++){var a=e[f].gLatLng;var k=Math.abs(d.lng()-a.lng())+Math.abs(d.lat()-a.lat());if(k<0.000001){(e[f]).list.push(b);g=true}}if(!g){var j={gLatLng:d,list:[b]};e.push(j)}}}return e};globalConfig.createMarker=globalConfig.createMarker||function(d,b,c){var a=new google.maps.Marker({position:d,icon:c});(function(f,e){google.maps.event.addListener(e,"click",function(){MOEMAP.openInfoWindow(e.getPosition(),f)})})(b,a);return a};globalConfig.infoWindowWidth=globalConfig.infoWindowWidth||"450px";globalConfig.calculateMulitpleTabsOneFeature=globalConfig.calculateMulitpleTabsOneFeature||function(a,l){var f=function(n){var k=document.createElement("div");k.style.width=globalConfig.infoWindowWidth;if(globalConfig.hasOwnProperty("infoWindowHeight")){k.style.height=globalConfig.infoWindowHeight}var j=new goog.ui.TabBar();for(var m=0;m<n.length;m++){var p=new goog.ui.Tab(n[m].label);p.content=n[m].content;j.addChild(p,true)}j.render(k);goog.dom.appendChild(k,goog.dom.createDom("div",{"class":"goog-tab-bar-clear"}));var o=goog.dom.createDom("div",{"class":"goog-tab-content"});if(globalConfig.hasOwnProperty("infoWindowContentHeight")){o.style.height=globalConfig.infoWindowContentHeight}if(globalConfig.hasOwnProperty("infoWindowContentWidth")){o.style.width=globalConfig.infoWindowContentWidth}goog.dom.appendChild(k,o);goog.events.listen(j,goog.ui.Component.EventType.SELECT,function(q){o.innerHTML=q.target.content});j.setSelectedTabIndex(0);return k};var g=a.length;var h=TABS_CALCULATOR.getContent(a[0].attributes,l);if(globalConfig.allowMultipleIdentifyResult){for(var e=1;e<g;e++){var b=TABS_CALCULATOR.getContent(a[e].attributes,l);for(var d=0;d<b.length;d++){h[d].content=h[d].content+b[d].content}}}for(var c=0;c<h.length;c++){if(typeof(l[c].head)!=="undefined"){h[c].content=l[c].head+h[c].content}if(typeof(l[c].tail)!=="undefined"){h[c].content=h[c].content+l[c].tail}}if((globalConfig.displayTotalIdentifyCount)&&(g>1)){if(globalConfig.allowMultipleIdentifyResult){h[0].content=globalConfig.totalFeatureReturned(g)+"<br>"+h[0].content}else{h[0].content=globalConfig.totalFeatureReturnedOnlyOneDisplayed(g)+"<br>"+h[0].content}}if(globalConfig.usePredefinedMultipleTabs){return f(h)}else{return h[0].content}};globalConfig.calculateCirclePolyline=globalConfig.calculateCirclePolyline||function(f,a){var b=[];for(var e=0;e<=360;e=e+10){var c=google.maps.geometry.spherical.computeOffset(f,a,e);b.push(new google.maps.LatLng(c.lat().toFixed(5),c.lng().toFixed(5)))}var d=new google.maps.Polyline({path:b,strokeColor:globalConfig.pointBuffer.color,strokeOpacity:globalConfig.pointBuffer.opacity,strokeWeight:globalConfig.pointBuffer.weight});return d};globalConfig.calculatePolylineBounds=globalConfig.calculatePolylineBounds||function(a){var c=new google.maps.LatLngBounds();var d=a.getPath();for(var b=0;b<d.length;b++){c.extend(d.getAt(b))}return c};globalConfig.disallowMouseClick=globalConfig.disallowMouseClick||false;MOEMAP=(function(){var y,m,u,z,n=[],c=false,w,f;function e(){if(z){z.setMap(null)}}function o(){if(n){for(var A=0;A<n.length;A++){n[A].setMap(null)}n.length=0}if(f){f.setMap(null)}e();if(globalConfig.usejQueryUITable){document.getElementById(globalConfig.queryTableDivId).innerHTML=""}}function j(F){if(typeof(F)!=="undefined"){for(var E=0;E<F.length;E++){var D=F[E];var A=D.getPaths().getLength();for(var C=0;C<A;C++){var B=new google.maps.Polyline({path:D.getPaths().getAt(C),strokeColor:globalConfig.twpBoundary.color,strokeOpacity:globalConfig.twpBoundary.opacity,strokeWeight:globalConfig.twpBoundary.weight,geodesic:false});B.setMap(y);n.push(B)}}}}function g(B,A){if(!z){z=new google.maps.InfoWindow({content:A,position:B})}else{z.setContent(A);z.setPosition(B)}z.open(y)}function d(A){if(globalConfig.isCoordinatesVisible){globalConfig.updateCoordinates(A.latLng.lat(),A.latLng.lng())}if(c){if(typeof(A)!=="undefined"){var B=google.maps.geometry.spherical.computeDistanceBetween(w,A.latLng);if(f){f.setMap(null)}f=globalConfig.calculateCirclePolyline(w,B);f.setMap(y);google.maps.event.addListener(f,"click",h);globalConfig.drawingCircleMessage(w.lat(),w.lng(),B/1000)}}}function p(A){if(A.hasOwnProperty("returnedAddress")){globalConfig.returnedAddress=A.returnedAddress}else{globalConfig.returnedAddress=A.address}A.map=y;A.preQueryCallback=globalConfig.preBufferCallback;A.postQueryCallback=globalConfig.postBufferCallback;A.layerList=globalConfig.queryLayerList;o();j(A.polylines);v(A,0)}function h(A){var C=google.maps.geometry.spherical.computeDistanceBetween(w,A.latLng)/1000;var B={radius:C,gLatLng:w,map:y,preQueryCallback:globalConfig.preBufferCallback,postQueryCallback:globalConfig.postBufferCallback,layerList:globalConfig.queryLayerList};o();v(B,0);c=false;TOOLSLEGEND.setPointBufferTool(false)}function v(C,A){if(A<C.layerList.length){C.currentLayerId=A;var D=C.preQueryCallback(C);var B=new gmaps.ags.Layer(C.layerList[A].url);B.query(D,function(E){C.layerList[A]["result"]=E;v(C,A+1)})}else{C.postQueryCallback(C)}}function t(A){if(TOOLSLEGEND.isPointBufferToolSelected()){if(!c){w=A.latLng;c=true}else{h(A)}return}e();var B={gLatLng:A.latLng,map:y,preQueryCallback:globalConfig.preIdentifyCallback,postQueryCallback:globalConfig.postIdentifyCallback,layerList:globalConfig.queryLayerList};if(globalConfig.hasOwnProperty("mergeFunction")){B.mergeFunction=globalConfig.mergeFunction}v(B,0)}function k(B){var A={};if(B.hasOwnProperty("address")){A=B;A.searchString=B.address}else{A={address:B,searchString:B}}if(B.hasOwnProperty("gLatLng")){A.map=y;globalConfig.addressGeocodingCallback(A)}else{MOEMAP.geocodeAddress(A)}}function q(A,C){var D=globalConfig.identifyMultiplePolygonLayersServicesTemplate.layerList[A];var B=D.result.features[C].geometry[0];B.setMap(y);B.setOptions(D.style);n.push(B)}function s(A){y=A;if(!globalConfig.disallowMouseClick){google.maps.event.addListener(y,"click",t)}google.maps.event.addListener(y,"mousemove",d);google.maps.event.addListener(y,"zoom_changed",r)}function r(){if(y.getZoom()>globalConfig.maxMapScale){y.setZoom(globalConfig.maxMapScale)}if(y.getZoom()<globalConfig.minMapScale){y.setZoom(globalConfig.minMapScale)}}function b(A){A.setMap(y);n.push(A)}function x(A){A.map=y;A.preQueryCallback=globalConfig.preConditionsCallback;A.postQueryCallback=globalConfig.postConditionsCallback;A.layerList=globalConfig.queryLayerList;v(A,0)}function l(A){A.map=y;A.callback=globalConfig.addressGeocodingCallback;A.address=A.searchString;LOCATOR.locate(A)}var a={init:s,clearOverlays:o,openInfoWindow:g,addOverlay:b,queryLayersWithConditionsExtent:x,geocodeAddress:l,addPolylinesToMap:j,mouseClickHandler:t,addressBufferCallback:p,identifyMultiplePolygonLayersWithLocation:k,showPolygonFeature:q};return a})(); /* Build Time: Oct 1, 2014 12:39:13 */ 